!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.p3lib=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function Main(width,height){this._width=width,this._height=height,this._assetManager=null,this._screenManager=null,this._preloader=null,this._game=null,this._resolution=1,this._scale="hd/",this._renderFPS=60,this._frameCount=0}var Application=require("./html5/Application"),Common=require("./html5/Common"),Preloader=require("./html5/screens/Preloader"),SceneManager=require("./html5/lib/SceneManager");require("./html5/tracking/Tracking");window.Main=Main,Main.prototype.init=function(){this._assetManager=p3.AssetManager.instance,this._screenManager=new SceneManager;var elementId="og-game-holder",params=new p3.ViewParams;params.width=this._width,params.height=this._height,params.holderID=elementId,params.rotateImageUrl="assets/images/system/rotate_device.jpg",params.rotateImageColor="#6b0404",PIXI.RETINA_PREFIX=/\_(?=[^_]*$)(.+)x/,p3.Tracking.DEBUG=!0,Common.tracking=new p3.Tracking,Common.tracking.init(new p3.TrackingModuleEcho(window.stats)),p3.Device.init(window.bowser);var unsupported=!1;if(p3.Device.isAndroidStockBrowser&&(unsupported=!0),document.addEventListener||(unsupported=!0),unsupported)return $("html").append('<div style="position:fixed; width:100%; height:100%; background-color:#6b0404; background-image:url(assets/images/system/unsupported.jpg); background-position:center center; background-repeat:no-repeat; background-size:100% auto;"></div>'),null;TweenMax.defaultOverwrite="none",TweenMax.ticker.fps(Common.FPS);var canvas=new p3.View(params);canvas.signals.ready.addOnce(function(canvas){var options={};options.view=canvas,options.transparent=!1,options.antialias=!1,options.preserveDrawingBuffer=!1,options.resolution=this._resolution,this._assetManager.scaleFactor=this._resolution;var stage=new PIXI.Container;Common.stage=stage;var renderer=PIXI.autoDetectRenderer(this._width,this._height,options);Common.renderer=renderer,this._screenManager.init(stage,renderer),Common.sceneManager=this._screenManager,Common.isWebGL=renderer instanceof PIXI.WebGLRenderer,Common.DEBUG_PAINT_MODE=p3.Utils.getURLParameter("paint",0);var timestep=new p3.Timestep;timestep.init(this.update,this.render,this),Common.timestep=timestep,Common.animator=new p3.Animator,Common.animator.init(),this.loadPreloader()},this),canvas.signals.resize.add(this.onCanvasResize,this);var hidden;"undefined"!=typeof document.hidden?(hidden="hidden",this.visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(hidden="msHidden",this.visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),document.addEventListener(this.visibilityChange,function(){document[hidden]?Howler.volume(0):Howler.volume(1)},!1)},Main.prototype.loadPreloader=function(){scale=this._scale;var prefix="sd/"===scale?"_0.5x":"",files=[{name:"preloader_bg",url:"assets/images/"+scale+"preloader"+prefix+".jpg"},{name:"preloader",url:"assets/images/"+scale+"preloader_0"+prefix+".json"},{name:"ui_0",url:"assets/images/"+scale+"ui_0"+prefix+".json"},{name:"copy",url:"strings/strings.json"},{name:"config_data",url:"strings/config.json"},{name:"logo_preloader",url:"assets/images/language/logo_preloader.png"}],sounds=[];files.length?(this._assetManager.addFiles(files,window.og.gameDir),this._assetManager.signalCompleted.addOnce(function(){this.loadAssets()},this),this._assetManager.load(),p3.AudioManager.instance.addSounds(sounds,[".mp3",".ogg"],"")):this.loadAssets()},Main.prototype.loadAssets=function(){var assetManager=p3.AssetManager.instance,config=assetManager.getJSON("config_data");Common.LEFT_TO_RIGHT=config.left_to_right,Common.tracking=new p3.Tracking,Common.tracking.init(new p3.TrackingModulePlaydom("lionguardcasual_bd_bd",config.locale,"bd","bd","FD 88AC1375-7E11-4B8D-8553-4F347A5A8FEF:87FCC843721490633DD6BBA20240171CCF9C80B17D327585")),Common.tracking.track(new p3.TrackingDataPlaydomDeviceInfo("device_info","desktop",null,null,null,null,null,null));var scale=this._scale,prefix="sd/"===scale?"_0.5x":"",files=[{name:"coffeehouse_48",url:"fonts/coffeehouse_48.json"},{name:"level_data",url:"data/levels.json"},{name:"level1",url:"data/levels/level_1_combo.json"},{name:"level2",url:"data/levels/level_2_combo.json"},{name:"objects_data",url:"data/objects.json"},{name:"characters",url:"images/"+scale+"characters"+prefix+".json"},{name:"end_game_0",url:"images/"+scale+"end_game_0"+prefix+".json"},{name:"enemies",url:"images/"+scale+"enemies"+prefix+".json"},{name:"game_0",url:"images/"+scale+"game_0"+prefix+".json"},{name:"help_0",url:"images/"+scale+"help_0"+prefix+".json"},{name:"intro_0",url:"images/"+scale+"intro_0"+prefix+".json"},{name:"kion",url:"images/"+scale+"kion"+prefix+".json"},{name:"level_0",url:"images/"+scale+"level_0"+prefix+".json"},{name:"level_bg_0",url:"images/"+scale+"level_bg_0"+prefix+".json"},{name:"pause_0",url:"images/"+scale+"pause_0"+prefix+".json"},{name:"pop_up_0",url:"images/"+scale+"pop_up_0"+prefix+".json"},{name:"ui_0",url:"images/"+scale+"ui_0"+prefix+".json"},{name:"end_game_fail",url:"images/"+scale+"end_game_fail"+prefix+".jpg"},{name:"end_game_success",url:"images/"+scale+"end_game_success"+prefix+".jpg"},{name:"lvl_select",url:"images/"+scale+"lvl_select"+prefix+".jpg"},{name:"splash",url:"images/"+scale+"splash"+prefix+".jpg"},{name:"video_fallback_01",url:"images/"+scale+"video_fallback_01"+prefix+".jpg"},{name:"video_fallback_02",url:"images/"+scale+"video_fallback_02"+prefix+".jpg"},{name:"video_fallback_03",url:"images/"+scale+"video_fallback_03"+prefix+".jpg"},{name:"video_fallback_04",url:"images/"+scale+"video_fallback_04"+prefix+".jpg"},{name:"video_fallback_05",url:"images/"+scale+"video_fallback_05"+prefix+".jpg"},{name:"btn_amazon",url:"images/language/btn_amazon.png"},{name:"btn_android",url:"images/language/btn_android.png"},{name:"btn_itunes",url:"images/language/btn_itunes.png"},{name:"end_game_title",url:"images/language/end_game_title.png"},{name:"help_title",url:"images/language/help_title.png"},{name:"logo",url:"images/language/logo.png"},{name:"paused_title",url:"images/language/paused_title.png"},{name:"particle_coin_background",url:"particles/particle_coin_background_3.json"},{name:"particle_enemy_hit_dustcloud",url:"particles/particle_enemy_hit_cloudburst.json"},{name:"particle_lives_start",url:"particles/particle_lives_start.json"},{name:"particle_roar_active_bubble",url:"particles/particle_roar_active_bubble.json"},{name:"particle_roar_speedlines",url:"particles/particle_roar_speedlines.json"},{name:"particle_coin_collect_burst",url:"particles/particle_coin_collect_burst.json"},{name:"particle_roar_active_btn_bg",url:"particles/particle_roar_active_btn_bg.json"},{name:"particle_roar_icon_pickup_bg",url:"particles/particle_roar_icon_pickup_bg.json"}],sounds=["music_grasslands","music_grasslands_fail","music_grasslands_roar","music_grasslands_success","music_loading-shorter-edited","music_lair","music_results","music_title_stg","sfx_tlg_amb_grasslands_lp","sfx_tlg_impact_hyena_01","sfx_tlg_impact_rock_01","sfx_tlg_impact_rock_02","sfx_tlg_impact_rock_03","sfx_tlg_impact_villaingeneral_01","sfx_tlg_kion_doublejump_01","sfx_tlg_kion_doublejump_02","sfx_tlg_kion_doublejump_03","sfx_tlg_kion_edgerecover_01","sfx_tlg_kion_edgerecover_02","sfx_tlg_kion_jump_01","sfx_tlg_kion_jump_02","sfx_tlg_kion_jump_03","sfx_tlg_kion_jump_04","sfx_tlg_kion_land_01","sfx_tlg_kion_land_02","sfx_tlg_kion_land_03","sfx_tlg_kion_land_04","sfx_tlg_kion_land_05","sfx_tlg_kion_runfs_01","sfx_tlg_kion_runfs_02","sfx_tlg_kion_runfs_03","sfx_tlg_kion_runfs_04","sfx_tlg_kion_runfs_05","sfx_tlg_kion_skid_01","sfx_tlg_kion_skid_02","sfx_tlg_ui_back","sfx_tlg_ui_charactersupprt_correct","sfx_tlg_ui_charactersupprt_incorrect","sfx_tlg_ui_collectcoin","sfx_tlg_ui_collectcoin_01","sfx_tlg_ui_collectcoin_02","sfx_tlg_ui_collectcoin_03","sfx_tlg_ui_earnmedal","sfx_tlg_ui_generalselect","sfx_tlg_ui_losesun","sfx_tlg_ui_mapselect","sfx_tlg_ui_pause","sfx_tlg_ui_play","sfx_tlg_ui_roarbutton_press","sfx_tlg_ui_roarbutton_ready","sfx_tlg_ui_roarcoin_collect","sfx_ui_app_press2"],vo=["vo_m1_intro","vo_beshte-1","vo_encouragement_010_kion","vo_hangingon_010_kion","vo_hitobstacle_010_kion","vo_hitobstacle_sundips_010_kion","vo_impacts_big_010_kion","vo_impacts_small_010_kion","vo_jumps_big_010_kion","vo_jumps_medium_011_kion","vo_jumps_medium_012_kion","vo_jumps_medium_013_kion","vo_jumps_small_010_kion","vo_jumps_small_011_kion","vo_jumps_small_012_kion","vo_jumps_small_013_kion","vo_kion-1","vo_kion-2","vo_kion-3","vo_landlong_010_kion","vo_landmedium_010_kion","vo_landshort_010_kion","vo_level2_end_shorter","vo_level2_results_screen","vo_missionfail_010_ono","vo_missionsuccess_020_bunga","vo_ono-recruit","vo_roarnotready_010_kion","vo_roarready_010_kion","vo_splashscreen_010_kion","vo_timerunningout_010_kion","vo_victoriouslaugh_011_kion"];files.length?(this._assetManager.addFiles(files,window.og.gameDir+"assets/"),this._assetManager.signalProgress.add(this.onLoadingProgress,this),this._assetManager.signalCompleted.addOnce(this.onLoadingCompleted,this),this._assetManager.load(),this._preloader=new Preloader,this._screenManager.add(this._preloader),p3.AudioManager.instance.addSounds(sounds,[".mp3",".ogg"],window.og.gameDir+"assets/audio/"),vo.length>0&&p3.AudioManager.instance.addSounds(vo,[".mp3",".ogg"],window.og.gameDir+"assets/audio/vo/")):this.startGame()},Main.prototype.startGame=function(){this._preloader.loadedPercentage=100,this._preloader.animateOut(null,this),this._preloader=null;var that=this;that._game=new Application,that._game.init(),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","game_load"))},Main.prototype.update=function(){this._screenManager.update(),Common.animator.update(),Common.DEBUG_PAINT_MODE>0&&this.paintBadImage(Common.stage),this._frameCount++,Common.frameCount=this._frameCount},Main.prototype.render=function(){(this._frameCount%2==0||60==this._fps)&&Common.renderer.render(Common.stage)},Main.prototype.paintBadImage=function(display,color){color=color||11141375;for(var child,i=0;i<display.children.length;++i)child=display.children[i],child instanceof PIXI.Sprite&&(1==Common.DEBUG_PAINT_MODE&&(child.texture.width%2!=0||child.texture.height%2!=0?child.tint=color:child.tint=16777215),2==Common.DEBUG_PAINT_MODE&&(child.position.x!==parseInt(child.position.x)||child.position.y!==parseInt(child.position.y)?child.tint=color:child.tint=16777215)),this.paintBadImage(child,color)},Main.prototype.onLoadingProgress=function(event){this._preloader.loadedPercentage=event.progress},Main.prototype.onLoadingCompleted=function(){this._assetManager.signalProgress.removeAll(),this._assetManager.signalCompleted.removeAll(),this._preloader.fontLoaded?this.startGame():this._preloader.signals.fontLoaded.addOnce(this.startGame,this)},Main.prototype.onCanvasResize=function(correct){correct&&(Common.renderer.resize(p3.View.width,p3.View.height),this._screenManager&&this._screenManager.resize())}},{"./html5/Application":2,"./html5/Common":3,"./html5/lib/SceneManager":22,"./html5/screens/Preloader":32,"./html5/tracking/Tracking":35}],2:[function(require,module,exports){function Application(){this._assetManager=null,this._screenManager=null}var Common=require("./Common"),SplashScreen=require("./screens/SplashScreen"),GameScreen=require("./screens/GameScreen"),LevelSelectScreen=require("./screens/LevelSelectScreen"),LevelCompleteScreen=require("./screens/LevelCompleteScreen"),LevelFailScreen=require("./screens/LevelFailScreen"),OutroScreen=require("./screens/OutroScreen"),AppOverlay=require("./overlays/AppOverlay"),PauseOverlay=require("./overlays/PauseOverlay"),HelpOverlay=require("./overlays/HelpOverlay"),Transition=require("./lib/Transition"),FadeTransition=require("./lib/FadeTransition");module.exports=Application,Application.prototype.init=function(){console.log("APPLICATION INITIALIZED"),this._assetManager=p3.AssetManager.instance,this._screenManager=Common.sceneManager,TweenMax.defaultOverwrite="none";for(var i in Common.colours){var gr=new PIXI.Graphics;gr.beginFill(Common.colours[i]),gr.drawRect(0,0,1,1),Common.generatedTextures[i+"Square"]=gr.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR)}this.showSplash()},Application.prototype.showSplash=function(){var screen=new SplashScreen;return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedPreviousScreen.addOnce(function(){},this),screen.signals.requestedNextScreen.addOnce(function(){this.showLevelSelect()},this),screen.signals.requestedAppOverlay.add(function(){this.showAppOverlay()},this),screen},Application.prototype.showGame=function(level){var screen=new GameScreen(level);return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedNextScreen.addOnce(function(complete,score,unlockedCharacter){complete?this.showLevelComplete(level,score,unlockedCharacter):this.showLevelFail(level)},this),screen.signals.requestedPreviousScreen.addOnce(function(){this.showGame(level)},this),screen.signals.requestedPauseOverlay.add(function(){this.showPauseOverlay(level,screen),screen.hideGUI(),screen.pause()},this),screen},Application.prototype.showLevelSelect=function(level){var screen=new LevelSelectScreen(level);return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedPreviousScreen.addOnce(function(){},this),screen.signals.requestedNextScreen.addOnce(function(level){console.log("showGame"),this.showGame(level)},this),screen.signals.requestedAppOverlay.add(function(){console.log("showAppOverlay"),this.showAppOverlay()},this),screen},Application.prototype.showAppOverlay=function(){var t=new Transition;t.replace=!1,t.push=!0;var screen=new AppOverlay;this._screenManager.add(screen,t),screen.signals.requestedNextScreen.addOnce(function(id){},this),screen.signals.requestedPreviousScreen.addOnce(function(id){this._screenManager.remove()},this)},Application.prototype.showPauseOverlay=function(level,gameScreen){var t=new Transition;t.replace=!1,t.push=!0;var screen=new PauseOverlay;this._screenManager.add(screen,t),screen.signals.requestedNextScreen.add(function(id){"home"==id?this.showLevelSelect():"restart"==id&&this.showGame(level)},this),screen.signals.requestedPreviousScreen.add(function(id){this._screenManager.remove(),gameScreen.showGUI(),gameScreen.resume()},this),screen.signals.requestedHelpOverlay.add(function(id){screen.hideGUI(),this.showHelpOverlay(screen)},this)},Application.prototype.showHelpOverlay=function(pauseScreen){var t=new Transition;t.replace=!1,t.push=!0;var screen=new HelpOverlay;this._screenManager.add(screen,t),screen.signals.requestedNextScreen.add(function(id){},this),screen.signals.requestedPreviousScreen.add(function(id){this._screenManager.remove(),pauseScreen.showGUI()},this)},Application.prototype.showLevelComplete=function(level,score,unlockedCharacter){var screen=new LevelCompleteScreen(level,score,unlockedCharacter);return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedPreviousScreen.addOnce(function(){},this),screen.signals.requestedNextScreen.addOnce(function(){level+1==2?this.showOutro():(Common.unlocks["level"+(level+2)]=!0,this.showLevelSelect(level+1))},this),screen},Application.prototype.showLevelFail=function(level){var screen=new LevelFailScreen(level);return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedPreviousScreen.addOnce(function(){},this),screen.signals.requestedNextScreen.addOnce(function(level){this.showLevelSelect(level)},this),screen},Application.prototype.showOutro=function(){if(0==this._assetManager.getJSON("config_data").enable_end_scene)return this.showLevelSelect(2),null;var screen=new OutroScreen;return this._screenManager.add(screen,this._getFadeTransition()),screen.signals.requestedPreviousScreen.addOnce(function(){},this),screen.signals.requestedNextScreen.addOnce(function(){this.showLevelSelect(2)},this),screen},Application.prototype._getTransition=function(){var transition=new Transition;return transition.replace=!0,transition.push=!1,transition},Application.prototype._getFadeTransition=function(){var transition=new FadeTransition(0,.4);return transition.replace=!0,transition.push=!1,transition}},{"./Common":3,"./lib/FadeTransition":20,"./lib/Transition":23,"./overlays/AppOverlay":24,"./overlays/HelpOverlay":25,"./overlays/PauseOverlay":26,"./screens/GameScreen":27,"./screens/LevelCompleteScreen":28,"./screens/LevelFailScreen":29,"./screens/LevelSelectScreen":30,"./screens/OutroScreen":31,"./screens/SplashScreen":34}],3:[function(require,module,exports){function Common(){}module.exports=Common,Common.STAGE_WIDTH=1900,Common.STAGE_HEIGHT=768,Common.stage=null,Common.renderer=null,Common.timestep=null,Common.animator=null,Common.touch=new PIXI.Point(0,0),Common.paused=!1,Common.isWebGL=!1,Common.DEBUG_PAINT_MODE=0,Common.frameCount=0,Common.FPS=60,Common.COUNTRY_CODE="en",Common.LEFT_TO_RIGHT=!0,Common.sceneManager=null,Common.generatedTextures={},Common.unlocks={level2:!1,fuli:!1,bunga:!1,ono:!1,beshte:!1},Common.roarTokens=0,Common.usedRoarMode=!1,Common.colours={black:0,blue:894681,darkYellow:15448907,yellow:15908669,orange:15423547,purple:6688657}},{}],4:[function(require,module,exports){function Avatar(){this._assetManager=p3.AssetManager.instance,this.maxMovementSpeed=390,this.maxDashSpeed=500,this.linearDamping=.98,this.gravity=30,this.jumpHeight=1e3,this.jumpRange=.5,this.acceleration=20,this.decceleration=40,this.velocity=new p3.Vector2(0,0),this.lastPosition=null,this.accelerating=!0,this.enableJump=!0,this.dashing=!1,this.allowPathCollisions=!0,this.hidden=!1,this._grounded=!1,this._angleTarget=0,this._hasDoubleJumped=!1,this._dashTimer=0,this._lastRoundedFrame=0,this._fallTimer=0,this._animationHolder=null,this._animations=null,this._currentAnimation=null,this._speedLinesHolder=null,this._speedLinesEmitter=null,this._roarBubbleEmitter=null,GameObject.call(this,"avatar",!1),this.signals.roarEnded=new signals.Signal}var Common=require("../Common"),GameObject=require("./GameObject"),Emitter=require("../general/Emitter"),SoundSFX=require("../general/SoundSFX");module.exports=Avatar,Avatar.prototype=Object.create(GameObject.prototype),Avatar.prototype.constructor=Avatar,Avatar.prototype.init=function(){this.collisionRect=new PIXI.Rectangle(-20,-50,70,50),this.areaRect=this.collisionRect.clone(),this.autoUpdate=!1,this._speedLinesHolder=new PIXI.Sprite,this._speedLinesHolder.x=40,this._speedLinesHolder.y=-80,this._speedLinesHolder.scale.x=.4,this.addChild(this._speedLinesHolder),Common.animator.add(TweenMax.to(this._speedLinesHolder.scale,.5,{x:.8,ease:Sine.easeInOut,yoyo:!0,repeat:-1})),this._animationHolder=new PIXI.Sprite,this.addChild(this._animationHolder),this._animations={},this._animations.celebration={id:"kioncelebrate",frames:43,anchor:new PIXI.Point(.5,.8),loop:!1},this._animations.collision={id:"kioncollision",frames:18,anchor:new PIXI.Point(.5,.8),loop:!1},this._animations.doubleJump={id:"kiondoublejump",frames:16,anchor:new PIXI.Point(.5,1),loop:!1},this._animations.jump={id:"kionjump",frames:17,startFrame:6,anchor:new PIXI.Point(.5,.7),loop:!1},this._animations.land={id:"kionland",frames:12,anchor:new PIXI.Point(.5,1),loop:!0},this._animations.recover={id:"kionrecover",frames:32,anchor:new PIXI.Point(.9,.3),loop:!1,onComplete:this.onRecoverComplete},this._animations.run={id:"kionrun",frames:10,anchor:new PIXI.Point(.5,.8),loop:!0},this._animations.runStart={id:"kionrunstart",frames:12,anchor:new PIXI.Point(.5,1),loop:!0};for(var i in this._animations)"fall"==i?this._animations[i].mc=new p3.MovieClip(this._generateFallAnimationSequence()):this._animations[i].mc=new p3.MovieClip(this._generateAnimationSequence(this._animations[i].id,this._animations[i].frames,this._animations[i].startFrame||0)),this._animations[i].mc.animationSpeed=46,this._animations[i].mc.looping=this._animations[i].loop,this._animations[i].mc.anchor=this._animations[i].anchor,this._animations[i].onComplete&&this._animations[i].mc.signals.animationComplete.add(this._animations[i].onComplete,this);this.setAnimation("run"),this._roarBubbleEmitter=Emitter.add(this,["cfx3_t_hollowcircle_alpha"],"particle_roar_active_bubble",0,-30,null,!1),this.lastPosition=new PIXI.Point(this.x,this.y)},Avatar.prototype.update=function(){if(this.hidden)return null;if(this.accelerating)this.velocity.x=Math.min(this.velocity.x+this.acceleration,this.dashing?this.maxDashSpeed:this.maxMovementSpeed);else{var perc=Math.max(.5,Math.abs(this.velocity.x)-this.decceleration)/Math.abs(this.velocity.x);this.velocity.x=this.velocity.x*perc,this.velocity.x>-1&&this.velocity.x<1&&(this.velocity.x=.01)}if(this._grounded){this.velocity.y=0,this._fallTimer=0;var angleDiff=Math.atan2(Math.sin(this._angleTarget-this.rotation),Math.cos(this._angleTarget-this.rotation));this.rotation=this.rotation+.1*angleDiff}else{this.velocity.y+=this.gravity,this._fallTimer++;var deg=null;this.velocity.y<0?deg=-60+60*(1-Math.max(this.velocity.y,-1e3)/-1e3):this.velocity.y>0&&(deg=20*(Math.min(this.velocity.y,1e3)/1e3)),this.rotation=deg*PIXI.DEG_TO_RAD}if(this.lastPosition.x=this.x,this.lastPosition.y=this.y,this.x+=this.velocity.x*p3.Timestep.deltaTime,this.y+=this.velocity.y*p3.Timestep.deltaTime,this.dashing&&this._dashTimer>0){this._dashTimer-=p3.Timestep.deltaTime,this.allowPathCollisions?this._speedLinesHolder.visible=!0:this._speedLinesHolder.visible=!1;var angle=Math.atan2(this.lastPosition.y-this.y,this.lastPosition.x-this.x);0>angle&&(angle=2*Math.PI+angle),this._speedLinesHolder.rotation=Math.max(angle,60*PIXI.DEG_TO_RAD)}else this.dashing&&this._dashTimer<=0&&(this.dashing=!1,this._roarBubbleEmitter.emit=!1,this.signals.roarEnded.dispatch());if("run"==this._currentAnimation&&this._grounded){var mc=this._animations[this._currentAnimation].mc;1==Math.round(mc.currentFrame)&&1!=this._lastRoundedFrame&&SoundSFX.playRandomFrom(["sfx_tlg_kion_runfs_01","sfx_tlg_kion_runfs_02","sfx_tlg_kion_runfs_03","sfx_tlg_kion_runfs_04","sfx_tlg_kion_runfs_05"]),this._lastRoundedFrame=Math.round(mc.currentFrame)}},Avatar.prototype.setRotation=function(targetY,startY,targetX,startX){this._angleTarget=Math.atan2(targetY-startY,targetX-startX),this._angleTarget<0&&(this._angleTarget=2*Math.PI+this._angleTarget)},Avatar.prototype.setAnimation=function(id){null!=this._currentAnimation&&(this._animations[this._currentAnimation].mc.gotoAndStop(0),this._animationHolder.removeChild(this._animations[this._currentAnimation].mc)),this._animations[id].mc.gotoAndPlay(0),this._animationHolder.addChild(this._animations[id].mc),this._currentAnimation=id},Avatar.prototype.touchStart=function(){this.enableJump&&(this._grounded?(this._jump(),this.setAnimation("jump"),SoundSFX.playRandomFrom(["sfx_tlg_kion_jump_01","sfx_tlg_kion_jump_02","sfx_tlg_kion_jump_03","sfx_tlg_kion_jump_04"]),SoundSFX.playRandomVOFrom("low",["vo_jumps_small_010_kion","vo_jumps_small_011_kion","vo_jumps_small_012_kion","vo_jumps_small_013_kion"])):!this._hasDoubleJumped&&this.velocity.y>-this.jumpHeight*this.jumpRange/2&&(this._jump(),this._hasDoubleJumped=!0,this.setAnimation("doubleJump"),SoundSFX.playRandomFrom(["sfx_tlg_kion_doublejump_01","sfx_tlg_kion_doublejump_02","sfx_tlg_kion_doublejump_03"]),SoundSFX.playRandomVOFrom("low",["vo_jumps_big_010_kion","vo_jumps_medium_011_kion","vo_jumps_medium_012_kion","vo_jumps_medium_013_kion"])))},Avatar.prototype.touchEnd=function(){this.velocity.y<-this.jumpHeight*this.jumpRange&&(this.velocity.y=-this.jumpHeight*this.jumpRange)},Avatar.prototype.celebrate=function(){this.accelerating&&(this.setAnimation("celebration"),this.accelerating=!1,this.enableJump=!1,SoundSFX.playRandomFrom(["sfx_tlg_kion_skid_01","sfx_tlg_kion_skid_02"]))},Avatar.prototype.knockBack=function(){this.setAnimation("collision"),this.accelerating=!1,this.velocity.x=-this.velocity.x,SoundSFX.playRandomFrom(["sfx_tlg_kion_skid_01","sfx_tlg_kion_skid_02"])},Avatar.prototype.dash=function(){this.dashing=!0,this._dashTimer=20,this.accelerating=!0,this.grounded&&this.setAnimation("run"),this._roarBubbleEmitter.emit=!0},Avatar.prototype.run=function(){this.accelerating=!0,this.setAnimation("run")},Avatar.prototype.pause=function(){this._animations[this._currentAnimation].mc.stop()},Avatar.prototype.resume=function(){this._animations[this._currentAnimation].mc.play()},Avatar.prototype.hide=function(){this.hidden=!0,this._animationHolder.visible=!1},Avatar.prototype.show=function(){this.hidden=!1,this._animationHolder.visible=!0},Avatar.prototype._jump=function(){this.velocity.x>=0&&(this._grounded=!1,this.velocity.y=-this.jumpHeight,this.setRotation(0,0,1,0)),this.accelerating||0!=Math.floor(this.velocity.x)||(this.accelerating=!0)},Avatar.prototype._generateAnimationSequence=function(animation,frameLimit,startFrame){for(var textureArr=[],i=startFrame;frameLimit>=i;i++){var precede=10>i?"0":"";textureArr.push(animation+precede+i)}for(var i=0;i<textureArr.length;i++)textureArr[i]=this._assetManager.getTexture(textureArr[i]);var sequence=new p3.MovieClipSequence;return sequence.addTextures(textureArr),sequence},Avatar.prototype._generateFallAnimationSequence=function(){for(var textureArr=[],i=0;i<=this._animations.fall.frames;i++){var precede=10>i?"0":"";textureArr.push(this._animations.fall.id+precede+i)}textureArr.push("kionfallstatic");for(var i=0;i<textureArr.length;i++)textureArr[i]=this._assetManager.getTexture(textureArr[i]);var sequence=new p3.MovieClipSequence;return sequence.addTextures(textureArr),sequence},Avatar.prototype.onRecoverComplete=function(){this.setAnimation("run"),this.accelerating=!0,this.enableJump=!0},Object.defineProperty(Avatar.prototype,"grounded",{get:function(){return this._grounded},set:function(value){return 0==this._grounded&&this.accelerating&&this.setAnimation("run"),0==this._grounded&&(SoundSFX.playRandomFrom(["sfx_tlg_kion_land_01","sfx_tlg_kion_land_02","sfx_tlg_kion_land_03","sfx_tlg_kion_land_04","sfx_tlg_kion_land_05"]),this._fallTimer>200?SoundSFX.playVO("low","vo_landlong_010_kion"):this._fallTimer>130?SoundSFX.playVO("low","vo_landmedium_010_kion"):this._fallTimer>60&&SoundSFX.playVO("low","vo_landshort_010_kion")),this._grounded=value,this._grounded&&(this._hasDoubleJumped=!1),this._grounded}})},{"../Common":3,"../general/Emitter":17,"../general/SoundSFX":18,"./GameObject":7}],5:[function(require,module,exports){function BackgroundImage(data){this._graphic=null,this._data=data,GameObject.call(this,"image",!0),this.tintable=!0}var GameObject=(require("../Common"),require("./GameObject"));module.exports=BackgroundImage,BackgroundImage.prototype=Object.create(GameObject.prototype),BackgroundImage.prototype.constructor=BackgroundImage,BackgroundImage.prototype.init=function(){this._graphic=new PIXI.Sprite(this._assetManager.getTexture(this._data.image)),void 0!=this._data.scale&&(this._graphic.scale=new PIXI.Point(this._data.scale,this._data.scale)),this.addChild(this._graphic),this.areaRect=new PIXI.Rectangle(0,0,this._graphic.width,this._graphic.height)},BackgroundImage.prototype.update=function(){},BackgroundImage.prototype.setTint=function(tint){this._graphic.tint=tint}},{"../Common":3,"./GameObject":7}],6:[function(require,module,exports){function Boulder1(){this._path=null,this.collided=!1,GameObject.call(this,"boulder1",!0)}var GameObject=(require("../Common"),require("./GameObject"));module.exports=Boulder1,Boulder1.prototype=Object.create(GameObject.prototype),Boulder1.prototype.constructor=Boulder1,Boulder1.prototype.init=function(){this._graphic=new PIXI.Sprite(this._assetManager.getTexture("m1rockobstacle")),this._graphic.scale=new PIXI.Point(2,2),this._graphic.anchor.y=1,this.addChild(this._graphic);var rect=this._assetManager.getJSON("objects_data").objects.m1rockobstacle.areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=new PIXI.Rectangle(rect.x+40,-80,50,60)},Boulder1.prototype.update=function(){},Boulder1.prototype.collide=function(){this.collided=!0}},{"../Common":3,"./GameObject":7}],7:[function(require,module,exports){function GameObject(type,removeIfOutsideBoundary){this._assetManager=p3.AssetManager.instance,this.signals={},this.signals.disposed=new signals.Signal,this.id=null,this.type=type,this.collisionRect=null,this.areaRect=null,this.removeIfOutsideBoundary=null==removeIfOutsideBoundary?!0:removeIfOutsideBoundary,this.removeMe=!1,this.removed=!1,this.autoUpdate=!0,this.tintable=!1,PIXI.Container.call(this)}require("../Common");module.exports=GameObject,GameObject.prototype=Object.create(PIXI.Container.prototype),GameObject.prototype.constructor=GameObject,GameObject.prototype.init=function(){},GameObject.prototype.update=function(){},GameObject.prototype.reset=function(){this.x=0,this.y=0,this.removeMe=!1},GameObject.prototype.dispose=function(){this.signals.disposed.dispatch(this),this.removed=!0},GameObject.prototype.pause=function(){},GameObject.prototype.resume=function(){},GameObject.prototype.drawCollisionRect=function(){var graphic=new PIXI.Graphics;this.addChild(graphic),graphic.lineStyle(1,16191773),graphic.drawRect(this.collisionRect.x,this.collisionRect.y,this.collisionRect.width,this.collisionRect.height)}},{"../Common":3}],8:[function(require,module,exports){function GameUI(){this._assetManager=p3.AssetManager.instance,this._farLeft=0,this._farRight=0,this._tokenCounter=null,this._sunCounter=null,this._suns=null,this._roarCounterParticle=null,this._roarCounter=null,this._roars=null,this._roarActive=!1,this._characterCollectBar=null,this._characterCollectIcons=null,this._tutorialFinger=null,this.tutorialFingerActive=!1,this.signals={},this.signals.roarActivated=new signals.Signal,this.signals.roarIconClicked=new signals.Signal,PIXI.Container.call(this)}var Common=require("../Common"),Emitter=(require("./GameObject"),require("../general/Emitter")),SoundSFX=require("../general/SoundSFX");module.exports=GameUI,GameUI.prototype=Object.create(PIXI.Container.prototype),GameUI.prototype.constructor=GameUI,GameUI.prototype.init=function(){this._sunCounter=new PIXI.Container,this._sunCounter.y=52;var bar=new PIXI.Sprite(this._assetManager.getTexture("hud_sun_bg"));this._sunCounter.addChild(bar),this.addChild(this._sunCounter),this._suns=[];for(var start=new PIXI.Point(50,36),margin=63,i=0;5>i;i++){var emptySun=new PIXI.Sprite(this._assetManager.getTexture("hud_sun_empty"));emptySun.anchor=new PIXI.Point(.5,.5);var sun=new PIXI.Sprite(this._assetManager.getTexture("hud_sun_full"));sun.anchor=new PIXI.Point(.5,.5),sun.scale=new PIXI.Point(0,0),sun.x=emptySun.x=start.x+i*margin,sun.y=emptySun.y=start.y,this._sunCounter.addChild(emptySun),this._sunCounter.addChild(sun),this._suns.push(sun),Common.animator.add(TweenMax.to(sun.scale,.5,{delay:1+.3*i,x:1,y:1,ease:Sine.easeOut,onStartScope:this,onStartParams:[sun],onStart:function(sun){Emitter.add(sun,["cfx3_t_smallray_alpha"],"particle_lives_start",0,0)}}))}this._tokenCounter=new PIXI.Container,this._tokenCounter.y=70;var bar=new PIXI.Sprite(this._assetManager.getTexture("hud_coin_bg"));bar.anchor.x=1,this._tokenCounter.addChild(bar);
var tokenImageHolder=new PIXI.Container;tokenImageHolder.x=-bar.width+65,tokenImageHolder.y=30,this._tokenCounter.addChild(tokenImageHolder);var particleHolder=new PIXI.Container;particleHolder.scale=new PIXI.Point(1.5,1.5),tokenImageHolder.addChild(particleHolder),this._particle=Emitter.add(particleHolder,["cfxm4_t_coinbg_rgb"],"particle_coin_background",0,0);var token=new PIXI.Sprite(this._assetManager.getTexture("hud_coin"));token.anchor=new PIXI.Point(.5,.5),tokenImageHolder.addChild(token),this.addChild(this._tokenCounter),this._roarCounter=new PIXI.Container,this._roarCounterParticle=Emitter.add(this._roarCounter,["cfx3_t_smallray_alpha"],"particle_roar_active_btn_bg",0,0,null,!1);var circle=new PIXI.Sprite(this._assetManager.getTexture("hud_roar_bg"));circle.anchor=new PIXI.Point(.5,.5),this._roarCounter.addChild(circle),this._roarKionIdle=new PIXI.Sprite(this._assetManager.getTexture("hud_roar_lion")),this._roarKionIdle.anchor=new PIXI.Point(.5,.5),this._roarCounter.addChild(this._roarKionIdle),this._roarKionRoar=new p3.MovieClip(this._generateAnimationSequence("hud_kionheadroar",13,2)),this._roarKionRoar.anchor=new PIXI.Point(.5,.5),this._roarKionRoar.visible=!1,this._roarKionRoar.gotoAndPlay(0),this._roarKionRoar.looping=!0,this._roarCounter.addChild(this._roarKionRoar),this._roarCounter.y=Common.STAGE_HEIGHT-120,this.addChild(this._roarCounter),this._tokenText=new p3.BitmapText("0",this._assetManager.getFontAtlas("coffeehouse_48"),p3.BitmapText.ALIGN_LEFT),this._tokenText.x=tokenImageHolder.x+45,this._tokenText.y=tokenImageHolder.y-35,this._tokenCounter.addChild(this._tokenText),this._roarCounter.hitArea=new PIXI.Rectangle(-60,-60,120,120),this._roarCounter.touchstart=this._roarCounter.mousedown=this.onRoarCounterPress.bind(this),this._roarCounter.interactive=!0,this._roars=[];for(var positions=[{rotation:0,x:0,y:-65},{rotation:90,x:65,y:0},{rotation:180,x:0,y:65},{rotation:270,x:-65,y:0}],i=0;i<positions.length;i++){var roarToken=new PIXI.Sprite(this._assetManager.getTexture("hud_roar_collected"));roarToken.anchor=new PIXI.Point(.5,.5),roarToken.rotation=positions[i].rotation*PIXI.DEG_TO_RAD,roarToken.x=positions[i].x,roarToken.y=positions[i].y,roarToken.alpha=0,Common.roarTokens>i&&(roarToken.alpha=1),this._roarCounter.addChild(roarToken);var roarActive=new PIXI.Sprite(this._assetManager.getTexture("hud_roar_active"));roarActive.anchor=new PIXI.Point(.5,.5),roarActive.rotation=positions[i].rotation*PIXI.DEG_TO_RAD,roarActive.x=positions[i].x,roarActive.y=positions[i].y,roarActive.alpha=0,this._roarCounter.addChild(roarActive),this._roars.push({token:roarToken,active:roarActive})}Common.roarTokens>=5&&this.activateRoar(),this._characterCollectBar=new PIXI.Sprite(this._assetManager.getTexture("character_bar")),this._characterCollectBar.anchor=new PIXI.Point(.5,1),this._characterCollectBar.x=Common.STAGE_WIDTH/2,this._characterCollectBar.y=Common.STAGE_HEIGHT+this._characterCollectBar.height,this.addChild(this._characterCollectBar),this._characterCollectIcons={};for(var characters=["bunga","ono","beshte","fuli"],positions=[-200,-66,66,200],i=0;i<characters.length;i++){var icon=new PIXI.Sprite(this._assetManager.getTexture("character_bar_grey_"+characters[i]));icon.anchor=new PIXI.Point(.5,.5),this._characterCollectIcons[characters[i]]=icon,icon.x=positions[i],icon.y=-(this._characterCollectBar.height/2),this._characterCollectBar.addChild(icon)}this._tutorialFingerHolder=new PIXI.Container,this.addChild(this._tutorialFingerHolder),this._tutorialBurst=new PIXI.Sprite(this._assetManager.getTexture("tutorial_burst")),this._tutorialBurst.anchor=new PIXI.Point(.5,.5),this._tutorialBurst.x=-50,this._tutorialBurst.y=-20,this._tutorialBurst.scale=new PIXI.Point(0,0),this._tutorialFingerHolder.addChild(this._tutorialBurst),this._tutorialFinger=new PIXI.Sprite(this._assetManager.getTexture("tutorial_hand")),this._tutorialFinger.anchor=new PIXI.Point(.5,1),this._tutorialFinger.x=0,this._tutorialFinger.y=100,this._tutorialFinger.alpha=0,this._tutorialFingerHolder.addChild(this._tutorialFinger),this._sunCounter.x=0-this._sunCounter.width,this._tokenCounter.x=Common.STAGE_WIDTH+this._tokenCounter.width,this._roarCounter.scale={x:0,y:0},Common.animator.add(TweenMax.to(this._roarCounter.scale,.5,{delay:1.5,x:1,y:1,ease:Back.easeOut}))},GameUI.prototype.resize=function(farLeft,farRight){this._farLeft=farLeft,this._farRight=farRight,TweenMax.isTweening(this._sunCounter)||this._sunCounter.x!=-this._sunCounter.width?TweenMax.isTweening(this._sunCounter)||(this._sunCounter.x=farLeft+50):Common.animator.add(TweenMax.to(this._sunCounter,.7,{delay:.5,x:farLeft+50,ease:Sine.easeOut})),TweenMax.isTweening(this._tokenCounter)||this._tokenCounter.x!=Common.STAGE_WIDTH+this._tokenCounter.width?TweenMax.isTweening(this._tokenCounter)||(this._tokenCounter.x=farRight-190):Common.animator.add(TweenMax.to(this._tokenCounter,.5,{delay:.7,x:farRight-190,ease:Sine.easeOut})),this._roarCounter.x=farRight-130},GameUI.prototype.animateToken=function(graphic,point,tokenAmount){this.addChild(graphic),graphic.position=point,TweenMax.to(graphic,.5,{x:this._tokenCounter.x-this._tokenCounter.width+50,y:this._tokenCounter.y+50,alpha:0,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._tokenText.text=tokenAmount.toString()}})},GameUI.prototype.loseLife=function(lives){var sun=this._suns[lives],tl=new TimelineMax;tl.to(sun.scale,.3,{x:1.2,y:1.2,ease:Sine.easeInOut}),tl.to(sun,.3,{rotation:90*PIXI.DEG_TO_RAD,ease:Sine.easeInOut},0),tl.to(sun,.5,{rotation:-360*PIXI.DEG_TO_RAD,ease:Sine.easeInOut},.3),tl.to(sun.scale,.5,{x:0,y:0,ease:Sine.easeInOut},.3),SoundSFX.play("sfx_tlg_ui_losesun")},GameUI.prototype.animateRoarToken=function(graphic,point){this.addChild(graphic),graphic.position=point,TweenMax.to(graphic,.5,{x:this._roarCounter.x,y:this._roarCounter.y,alpha:0,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){Common.roarTokens<=this._roars.length?this._roars[Common.roarTokens-1].token.alpha=1:Common.roarTokens>=5&&this.activateRoar()}})},GameUI.prototype.activateRoar=function(){if(!this._roarActive){this._roarActive=!0;for(var i=0;i<this._roars.length;i++)Common.animator.add(TweenMax.to(this._roars[i].active,.7,{alpha:1,ease:Sine.easeInOut,yoyo:!0,repeat:-1}));var tl=new TimelineMax({repeat:-1});tl.to(this._roarCounter.scale,.4,{delay:1,x:1.2,y:1.2,ease:Sine.easeInOut}),tl.to(this._roarCounter.scale,.4,{x:1,y:1,ease:Sine.easeInOut}),Common.animator.add(tl),SoundSFX.play("sfx_tlg_ui_roarbutton_ready"),SoundSFX.playVO("low","vo_roarready_010_kion"),this._roarCounterParticle.emit=!0,this.signals.roarActivated.dispatch()}},GameUI.prototype.deactivateRoar=function(){if(console.log("deactivateRoar: "+this._roarActive),this._roarActive){this._roarActive=!1;for(var i=0;i<this._roars.length;i++)TweenMax.killTweensOf(this._roars[i].active),this._roars[i].active.alpha=0,this._roars[i].token.alpha=0;TweenMax.killTweensOf(this._roarCounter.scale),Common.animator.add(TweenMax.to(this._roarCounter.scale,.3,{x:1,y:1,ease:Sine.easeInOut})),this._roarCounter.interactive=!1}},GameUI.prototype.roarModeEnded=function(){Common.animator.add(TweenMax.to(this._roarKionRoar.scale,.3,{x:0,y:0,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._roarKionIdle.visible=!0,this._roarKionRoar.visible=!1,this._roarKionRoar.scale=new PIXI.Point(1,1),this._roarCounterParticle.emit=!1,this._roarKionIdle.scale=new PIXI.Point(0,0),Common.animator.add(TweenMax.to(this._roarKionIdle.scale,.3,{x:1,y:1,ease:Sine.easeInOut}))}}))},GameUI.prototype.hideRoar=function(){this.hidden||(this.hidden=!0,this._roarCounter.interactive=!1,Common.animator.add(TweenMax.to(this._roarCounter,.5,{y:Common.STAGE_HEIGHT+200,ease:Back.easeIn})))},GameUI.prototype.collectCharacter=function(character){for(var i in this._characterCollectIcons)1==Common.unlocks[i]?this._characterCollectIcons[i].texture=this._assetManager.getTexture("character_bar_collected_"+i):this._characterCollectIcons[i].texture=this._assetManager.getTexture("character_bar_grey_"+i);Common.animator.add(TweenMax.to(this._characterCollectBar,.5,{y:Common.STAGE_HEIGHT-20,ease:Expo.easeOut,onCompleteScope:this,onComplete:function(){var icon=this._characterCollectIcons[character];Common.animator.add(TweenMax.to(icon.scale,.2,{x:0,y:0,ease:Sine.easeIn,onCompleteScope:this,onComplete:function(){Common.animator.add(TweenMax.to(icon.scale,.4,{x:1,y:1,ease:Back.easeOut})),icon.texture=this._assetManager.getTexture("character_bar_collected_"+character),Common.unlocks[character]=!0;var radial=new PIXI.Sprite(this._assetManager.getTexture("character_bar_radial"));radial.anchor=new PIXI.Point(.5,.5),radial.scale=new PIXI.Point(0,0),radial.x=icon.x,radial.y=icon.y,this._characterCollectBar.addChild(radial),Common.animator.add(TweenMax.to(radial.scale,.5,{x:1,y:1,ease:Sine.easeOut})),Common.animator.add(TweenMax.to(radial,.2,{delay:.3,alpha:0})),Common.animator.add(TweenMax.to(this._characterCollectBar,.5,{delay:1,y:Common.STAGE_HEIGHT+this._characterCollectBar.height,ease:Expo.easeIn}))}}))}})),SoundSFX.play("sfx_tlg_ui_charactersupprt_correct");var sounds={beshte:"vo_beshte-1",fuli:"vo_level2_end_shorter",ono:"vo_ono-recruit"};sounds[character]&&SoundSFX.playVO("high",sounds[character],null,1e3)},GameUI.prototype.activateTutorialFinger=function(x,y,scaleX,scaleY,rotation){void 0==x?this._tutorialFingerHolder.x=Common.STAGE_WIDTH/2:this._tutorialFingerHolder.x=x,void 0==y?this._tutorialFingerHolder.y=Common.STAGE_HEIGHT/2+100:this._tutorialFingerHolder.y=y,void 0==scaleX?this._tutorialFingerHolder.scale.x=1:this._tutorialFingerHolder.scale.x=scaleX,void 0==scaleY?this._tutorialFingerHolder.scale.y=1:this._tutorialFingerHolder.scale.y=scaleY,void 0==rotation?this._tutorialFingerHolder.rotation=0:this._tutorialFingerHolder.rotation=rotation*PIXI.DEG_TO_RAD,TweenMax.killTweensOf(this._tutorialFinger),TweenMax.killTweensOf(this._tutorialBurst),this.tutorialFingerActive=!0,this._tutorialFinger.scale.y=1,this._tutorialFinger.alpha=0,this._tutorialBurst.scale=new PIXI.Point(0,0),this._tutorialFingerHolder.visible=!0;var tl=new TimelineMax({repeat:-1});Common.animator.add(tl),tl.to(this._tutorialFinger.scale,.5,{y:.7,ease:Sine.easeInOut}),tl.to(this._tutorialFinger.scale,1,{y:1,ease:Elastic.easeOut}),tl.to(this._tutorialBurst.scale,.3,{x:1,y:1,ease:Expo.easeOut},.5),tl.to(this._tutorialBurst.scale,0,{x:0,y:0},1),Common.animator.add(TweenMax.to(this._tutorialFinger,.5,{alpha:1}))},GameUI.prototype.deactivateTutorialFinger=function(){this.tutorialFingerActive=!1,TweenMax.killTweensOf(this._tutorialFinger.scale),Common.animator.add(TweenMax.to(this._tutorialFinger,.5,{alpha:0,onCompleteScope:this,onComplete:function(){this._tutorialFingerHolder.visible=!1}}))},GameUI.prototype.hideGUI=function(){this._roarActive&&(this._roarCounter.interactive=!1)},GameUI.prototype.showGUI=function(){this._roarActive&&(this._roarCounter.interactive=!0)},GameUI.prototype.pause=function(){this._roarKionRoar.stop()},GameUI.prototype.resume=function(){this._roarKionRoar.play()},GameUI.prototype._generateAnimationSequence=function(animation,frameLimit,startFrame,skippedFrames){for(var textureArr=[],i=startFrame;frameLimit>=i;i++){if(null!=skippedFrames){for(var found=!1,j=0;j<skippedFrames.length;j++)if(skippedFrames[j]==i){found=!0;break}if(found)continue}var precede=10>i?"0":"";textureArr.push(animation+precede+i)}for(var i=0;i<textureArr.length;i++)textureArr[i]=this._assetManager.getTexture(textureArr[i]);var sequence=new p3.MovieClipSequence;return sequence.addTextures(textureArr),sequence},GameUI.prototype.onRoarCounterPress=function(){this._roarActive?(this.deactivateRoar(),this.signals.roarIconClicked.dispatch(),SoundSFX.play("sfx_tlg_ui_roarbutton_press"),this._roarKionIdle.visible=!1,this._roarKionRoar.visible=!0):SoundSFX.isSoundPlaying("vo_roarnotready_010_kion")||SoundSFX.playVO("low","vo_roarnotready_010_kion")}},{"../Common":3,"../general/Emitter":17,"../general/SoundSFX":18,"./GameObject":7}],9:[function(require,module,exports){function HiddenCharacter(character){this.character=character,this.collected=!1,this.running=!1,this.stop=!1,this._loops=0,GameObject.call(this,"hiddenCharacter",!0)}var Common=require("../Common"),GameObject=require("./GameObject");module.exports=HiddenCharacter,HiddenCharacter.prototype=Object.create(GameObject.prototype),HiddenCharacter.prototype.constructor=HiddenCharacter,HiddenCharacter.prototype.init=function(){var idle,anchor=new PIXI.Point(0,1),scale=new PIXI.Point(1,1);this._animationHolder=new PIXI.Sprite,this.addChild(this._animationHolder),this._animations={},"beshte"==this.character?(this._animations.idle={id:"beshtecelebrationidle",frames:0,anchor:new PIXI.Point(-.2,1),scale:scale,loop:!0},this._animations.celebration={id:"beshtecelebrate",frames:24,anchor:new PIXI.Point(-.2,1),scale:scale,loop:!1,onComplete:function(){0==this._loops&&(Common.animator.setTimeout(function(){this._animations[this._currentAnimation].mc.gotoAndPlay(0)},.5,this),this._loops++)}},this._animations.run={id:"beshterun",frames:13,anchor:new PIXI.Point(0,1),scale:scale,loop:!0},idle="beshtecelebrationidle00",this.stop=!0):"bunga"==this.character?(anchor.x=.2,anchor.y=.9,scale.x=scale.y=1.3,this._animations.idle={id:"bungacelebration",frames:1,anchor:anchor,loop:!0,scale:scale,skippedFrames:[0]},this._animations.celebration={id:"bungacelebration",frames:39,skippedFrames:[9],scale:scale,anchor:anchor,loop:!0},this._animations.run={id:"bungarun",frames:13,anchor:anchor,scale:scale,loop:!0},idle="bungacelebration01",this.stop=!0):"fuli"==this.character?(anchor.y=.8,this._animations.idle={id:"fulicelebrationidle",frames:0,anchor:anchor,scale:scale,loop:!0},this._animations.celebration={id:"fulicelebrationidle",frames:0,anchor:anchor,scale:scale,loop:!0},this._animations.run={id:"fulirun",frames:9,anchor:anchor,scale:scale,loop:!0},idle="fulicelebrationidle00"):"ono"==this.character&&(anchor.x=-.2,scale.x=scale.y=.7,this._animations.idle={id:"onoflight",frames:22,anchor:anchor,scale:scale,loop:!0},this._animations.celebration={id:"onocelebrate",frames:24,anchor:anchor,scale:scale,loop:!0},this._animations.run={id:"onoflight",frames:22,anchor:anchor,scale:scale,loop:!0},idle="onoidle00");for(var i in this._animations)this._animations[i].mc=new p3.MovieClip(this._generateAnimationSequence(this._animations[i].id,this._animations[i].frames,this._animations[i].startFrame||0,this._animations[i].skippedFrames)),this._animations[i].mc.animationSpeed=50,this._animations[i].mc.looping=this._animations[i].loop,this._animations[i].mc.anchor=this._animations[i].anchor,this._animations[i].mc.scale=this._animations[i].scale,this._animations[i].onComplete&&this._animations[i].mc.signals.animationComplete.add(this._animations[i].onComplete,this);this.setAnimation("idle");var rect=this._assetManager.getJSON("objects_data").objects[idle].areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=this.areaRect.clone(),this.collisionRect.y=-1e3,this.collisionRect.height=1500,"bunga"==this.character&&(this.collisionRect.x-=50,this.collisionRect.width+=50)},HiddenCharacter.prototype.update=function(){this.running&&(this.x+=7)},HiddenCharacter.prototype.setAnimation=function(id){null!=this._currentAnimation&&(this._animations[this._currentAnimation].mc.gotoAndStop(0),this._animationHolder.removeChild(this._animations[this._currentAnimation].mc)),this._animations[id].mc.gotoAndPlay(0),this._animationHolder.addChild(this._animations[id].mc),this._currentAnimation=id},HiddenCharacter.prototype.collect=function(){if("beshte"==this.character||"fuli"==this.character){var tl=new TimelineMax;Common.animator.add(tl),tl.to(this._animationHolder.scale,.3,{y:.9,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this.setAnimation("celebration")}}),tl.to(this._animationHolder.scale,1,{y:1,ease:Elastic.easeOut})}else this.setAnimation("celebration")},HiddenCharacter.prototype.run=function(){this.running=!0,this.setAnimation("run")},HiddenCharacter.prototype.pause=function(){this._animations[this._currentAnimation].mc.stop()},HiddenCharacter.prototype.resume=function(){this._animations[this._currentAnimation].mc.play()},HiddenCharacter.prototype._generateAnimationSequence=function(animation,frameLimit,startFrame,skippedFrames){for(var textureArr=[],i=startFrame;frameLimit>=i;i++){if(null!=skippedFrames){for(var found=!1,j=0;j<skippedFrames.length;j++)if(skippedFrames[j]==i){found=!0;break}if(found)continue}var precede=10>i?"0":"";textureArr.push(animation+precede+i)}for(var i=0;i<textureArr.length;i++)textureArr[i]=this._assetManager.getTexture(textureArr[i]);var sequence=new p3.MovieClipSequence;return sequence.addTextures(textureArr),sequence}},{"../Common":3,"./GameObject":7}],10:[function(require,module,exports){function Hole(){this._path=null,this.dropped=!1,GameObject.call(this,"hole",!0),this.tintable=!0}var GameObject=(require("../Common"),require("./GameObject"));module.exports=Hole,Hole.prototype=Object.create(GameObject.prototype),Hole.prototype.constructor=Hole,Hole.prototype.init=function(){console.log("HOLE"),this._graphic=new PIXI.Sprite(this._assetManager.getTexture("m1holeback")),this._graphic.scale=new PIXI.Point(2,2),this._graphic.anchor.y=1,this.addChild(this._graphic);var rect=this._assetManager.getJSON("objects_data").objects.m1holeback.areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=new PIXI.Rectangle(130,-270,100,500)},Hole.prototype.update=function(){},Hole.prototype.collide=function(){},Hole.prototype.setTint=function(tint){this._graphic.tint=tint}},{"../Common":3,"./GameObject":7}],11:[function(require,module,exports){function Hyena(){this._path=null,this.collided=!1,this._animations=null,this._currentAnimation=null,GameObject.call(this,"hyena",!0)}var GameObject=(require("../Common"),require("./GameObject"));module.exports=Hyena,Hyena.prototype=Object.create(GameObject.prototype),Hyena.prototype.constructor=Hyena,Hyena.prototype.init=function(){var rect=this._assetManager.getJSON("objects_data").objects["hyena01-idle00"].areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=new PIXI.Rectangle(10,-rect.height+40,80,rect.height-40),this._animations={},Math.random()<.5?(this._animations.idle={id:"hyena01-idle",animationSpeed:50,frames:24,anchor:new PIXI.Point(0,1),loop:!0},this._animations.hide={id:"hyena01-hide",animationSpeed:40,frames:0,anchor:new PIXI.Point(0,.8),loop:!1}):(this._animations.idle={id:"hyena02-idle",animationSpeed:50,frames:24,anchor:new PIXI.Point(0,1),loop:!0},this._animations.hide={id:"hyena02-hide",animationSpeed:40,frames:10,anchor:new PIXI.Point(.7,.65),loop:!1});for(var i in this._animations)this._animations[i].mc=new p3.MovieClip(this._generateAnimationSequence(this._animations[i].id,this._animations[i].frames,this._animations[i].startFrame||0)),this._animations[i].mc.animationSpeed=this._animations[i].animationSpeed,this._animations[i].mc.looping=this._animations[i].loop,this._animations[i].mc.anchor=this._animations[i].anchor;this.setAnimation("idle")},Hyena.prototype.update=function(){},Hyena.prototype.collide=function(){this.collided=!0,this._animations[this._currentAnimation].mc.scale.x=-1,this._animations[this._currentAnimation].mc.anchor.x=1},Hyena.prototype.hide=function(){this.collided=!0,this.setAnimation("hide")},Hyena.prototype.setAnimation=function(id){null!=this._currentAnimation&&(this._animations[this._currentAnimation].mc.gotoAndStop(0),this.removeChild(this._animations[this._currentAnimation].mc)),this._animations[id].mc.gotoAndPlay(0),this.addChild(this._animations[id].mc),this._currentAnimation=id},Hyena.prototype.pause=function(){this._animations[this._currentAnimation].mc.stop()},Hyena.prototype.resume=function(){this._animations[this._currentAnimation].mc.play()},Hyena.prototype._generateAnimationSequence=function(animation,frameLimit,startFrame){for(var textureArr=[],i=startFrame;frameLimit>=i;i++){var precede=10>i?"0":"";textureArr.push(animation+precede+i)}for(var i=0;i<textureArr.length;i++)textureArr[i]=this._assetManager.getTexture(textureArr[i]);var sequence=new p3.MovieClipSequence;return sequence.addTextures(textureArr),sequence}},{"../Common":3,"./GameObject":7}],12:[function(require,module,exports){function MapReader(levelJSON,xDivision){this._assetManager=p3.AssetManager.instance,this.levelJSON=levelJSON,this.xDivision=xDivision||5e3,this.objectGroups=null,this.paths=null,this._imageLookUp=null,this.lowestPathPoint=null,PIXI.Container.call(this),this.init()}require("../Common");module.exports=MapReader,MapReader.prototype=Object.create(PIXI.Container.prototype),MapReader.prototype.constructor=MapReader,MapReader.prototype.init=function(){console.log(this.levelJSON);var json=this._assetManager.getJSON(this.levelJSON);this.objectsData=[],this.paths=[];for(var lowestPathPoint=0,k=0;k<json.layers.length;k++)for(var i=0;i<json.layers[k].objects.length;i++){for(var o=json.layers[k].objects[i],t=null,j=0;j<json.tilesets.length;j++)if(o.gid==json.tilesets[j].firstgid)t=json.tilesets[j].tiles[0];else if(json.tilesets[j].firstgid<=o.gid-1)for(var l in json.tilesets[j].tiles)json.tilesets[j].firstgid+Number(l)==o.gid&&(t=json.tilesets[j].tiles[l]);if(null!=t)if("interactiveLayer"==json.layers[k].name||"holes"==json.layers[k].name){var obj={type:t.image.replace("tiles/","").replace(".png",""),layer:json.layers[k].name,x:Math.round(o.x),y:Math.round(o.y),data:{}};this.objectsData.push(obj)}else{var obj={type:"image",layer:json.layers[k].name,x:Math.round(o.x),y:Math.round(o.y),data:{image:t.image.replace("tiles/","").replace(".png",""),scale:2}};if(this.objectsData.push(obj),void 0!=t.objectgroup&&void 0!=t.objectgroup.objects[0])for(var j=1;j<t.objectgroup.objects[0].polyline.length-1;j++){var p1=t.objectgroup.objects[0].polyline[j],p2=t.objectgroup.objects[0].polyline[j+1];this.paths.push([{x:Math.round(o.x+p1.x),y:Math.round(o.y+p1.y-o.height)},{x:Math.round(o.x+p2.x),y:Math.round(o.y+p2.y-o.height)}]),Math.round(o.y+p1.y-o.height)>lowestPathPoint&&(lowestPathPoint=Math.round(o.y+p1.y-o.height)),Math.round(o.y+p2.y-o.height)>lowestPathPoint&&(lowestPathPoint=Math.round(o.y+p2.y-o.height))}}}console.log("total objects: "+this.objectsData.length),this.lowestPathPoint=lowestPathPoint,this.objectGroups=[];var id=1,furthestObject=null;for(var i in this.objectsData)null==furthestObject?furthestObject=this.objectsData[i]:this.objectsData[i].x>furthestObject.x&&(furthestObject=this.objectsData[i]),this.objectsData[i].id=id.toString(),id++;if(furthestObject)for(var maxGroups=Math.ceil(furthestObject.x/this.xDivision),objectLookup=this._assetManager.getJSON("objects_data"),i=0;maxGroups>i;i++){var group=[];this.objectGroups.push(group);for(var j in this.objectsData)"image"==this.objectsData[j].type?this.objectsData[j].areaRectX=0:void 0!=objectLookup.objects[this.objectsData[j].type]&&(this.objectsData[j].areaRectX=objectLookup.objects[this.objectsData[j].type].areaRect.x),this.objectsData[j].x+this.objectsData[j].areaRectX>=i*this.xDivision&&this.objectsData[j].x+this.objectsData[j].areaRectX<(i+1)*this.xDivision&&group.push(this.objectsData[j]),this.objectsData[j].x+this.objectsData[j].areaRectX<0&&0==i&&group.push(this.objectsData[j])}},MapReader.prototype.update=function(){},MapReader.prototype.mapObjects=function(minX,maxX){for(var ret=[],i=0;i<this.objectGroups.length;i++)(i*this.xDivision>=minX&&i*this.xDivision<maxX||(i+1)*this.xDivision>=minX&&(i+1)*this.xDivision<maxX||i*this.xDivision<minX&&(i+1)*this.xDivision>maxX)&&ret.push(this.objectGroups[i]);return ret},MapReader.prototype.getLevelLayers=function(){for(var json=this._assetManager.getJSON(this.levelJSON),layers=[],i=0;i<json.layers.length;i++)"fgObjects"!=json.layers[i].name&&"fgGrass"!=json.layers[i].name&&layers.push(json.layers[i].name);return layers},MapReader.prototype.getForegroundLayers=function(){for(var json=this._assetManager.getJSON(this.levelJSON),layers=[],i=0;i<json.layers.length;i++)("fgObjects"==json.layers[i].name||"fgGrass"==json.layers[i].name)&&layers.push(json.layers[i].name);return layers},MapReader.prototype.addObject=function(image,layer,x,y,data){var obj={type:image,layer:layer,x:x,y:y,data:data};this.objectsData.push(obj);var group=Math.floor(x/this.xDivision);this.objectGroups[group].push()},MapReader.prototype.dispose=function(){this.signals.disposed.dispatch(this)},MapReader.prototype.pause=function(){},MapReader.prototype.resume=function(){},Object.defineProperty(MapReader.prototype,"type",{get:function(){return this._type}})},{"../Common":3}],13:[function(require,module,exports){function RoarToken(){this._graphic=null,this.hasBeenCollected=!1,GameObject.call(this,"roarToken",!0)}var GameObject=(require("../Common"),require("./GameObject")),Emitter=require("../general/Emitter");module.exports=RoarToken,RoarToken.prototype=Object.create(GameObject.prototype),RoarToken.prototype.constructor=RoarToken,RoarToken.prototype.init=function(){this._graphic=new PIXI.Sprite(this._assetManager.getTexture("lion_coin")),this._graphic.anchor=new PIXI.Point(.5,.5),this.addChild(this._graphic);var rect=this._assetManager.getJSON("objects_data").objects.lion_coin.areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=this.areaRect.clone(),this._graphic.x+=rect.width/2,this._graphic.y-=rect.height/2,this.collisionRect.x+=rect.width/2,this.collisionRect.y-=rect.height/2,this._particle=Emitter.add(this,["cfx3_t_smallray_alpha"],"particle_roar_icon_pickup_bg",rect.width/2,-(rect.height/2))},RoarToken.prototype.update=function(){},RoarToken.prototype.collect=function(){this.hasBeenCollected=!0,this.visible=!1},Object.defineProperty(RoarToken.prototype,"graphic",{get:function(){return this._graphic}})},{"../Common":3,"../general/Emitter":17,"./GameObject":7}],14:[function(require,module,exports){function SceneImage(){this._graphic=null,this._data=null,this._pool=null,GameObject.call(this,"image",!0),this.tintable=!0,this.init()}var GameObject=(require("../Common"),require("./GameObject"));module.exports=SceneImage,SceneImage.prototype=Object.create(GameObject.prototype),SceneImage.prototype.constructor=SceneImage,SceneImage.prototype.init=function(){this._graphic=new PIXI.Sprite,this.addChild(this._graphic)},SceneImage.prototype.create=function(data,pool){this._data=data,this._pool=pool,this._graphic.texture=this._assetManager.getTexture(this._data.image),void 0!=this._data.scale&&(this._graphic.scale=new PIXI.Point(this._data.scale,this._data.scale)),this._graphic.anchor.y=1,this.areaRect=new PIXI.Rectangle(0,-this._graphic.height,this._graphic.width,this._graphic.height)},SceneImage.prototype.dispose=function(){this._graphic.anchor=new PIXI.Point(0,0),this._graphic.scale=new PIXI.Point(1,1),this._graphic.tint=16777215,this.removeChild(this._graphic),this._pool._used.indexOf(this)>-1&&this._pool.free(this)},SceneImage.prototype.update=function(){},SceneImage.prototype.setTint=function(tint){this._graphic.tint=tint}},{"../Common":3,"./GameObject":7}],15:[function(require,module,exports){function Token(){this._graphic=null,this._particle=null,this.hasBeenCollected=!1,this.magnet=!1,GameObject.call(this,"token",!0)}var GameObject=(require("../Common"),require("./GameObject")),Emitter=require("../general/Emitter");module.exports=Token,Token.prototype=Object.create(GameObject.prototype),Token.prototype.constructor=Token,Token.prototype.init=function(){this._particle=Emitter.add(this,["cfxm4_t_coinbg_rgb"],"particle_coin_background",25,-18),this._graphic=new PIXI.Sprite(this._assetManager.getTexture("sun_coin")),this._graphic.anchor=new PIXI.Point(.5,.5),this.addChild(this._graphic);var rect=this._assetManager.getJSON("objects_data").objects.token.areaRect;this.areaRect=new PIXI.Rectangle(rect.x,rect.y,rect.width,rect.height),this.collisionRect=this.areaRect.clone(),this._graphic.x+=rect.width/2,this._graphic.y-=rect.height/2},Token.prototype.dispose=function(){null!=this._particle&&(Emitter.destroy(this._particle),this._particle=null)},Token.prototype.update=function(){},Token.prototype.collect=function(){this.hasBeenCollected=!0,this.visible=!1,Emitter.destroy(this._particle),this._particle=null},Token.prototype.pause=function(){null!=this._particle&&(this._particle.emit=!1)},Token.prototype.resume=function(){null!=this._particle&&(this._particle.emit=!0)},Object.defineProperty(Token.prototype,"graphic",{get:function(){return this._graphic}})},{"../Common":3,"../general/Emitter":17,"./GameObject":7}],16:[function(require,module,exports){function World(screenFocusPoint,viewBoundary,activeBoundary){this.signals={},this.signals.collisionFired=new signals.Signal,this._screenFocusPoint=screenFocusPoint,this._view=screenFocusPoint.clone(),this._viewBoundary=viewBoundary,this._activeBoundary=activeBoundary,this._camera=null,this._layers=null,this._collisions=null,this.currentTint=16777215,this.cameraDelay=.2,PIXI.Container.call(this)}require("../Common");module.exports=World,World.prototype=Object.create(PIXI.Container.prototype),World.prototype.constructor=World,World.prototype.init=function(){this._camera=new p3.Camera(this._view,!0),this._layers={},this._collisions=[]},World.prototype.update=function(){for(var i in this._layers)for(var cont=this._layers[i].container,j=0;j<this._layers[i].objects.length;j++){var obj=this._layers[i].objects[j];obj.autoUpdate&&obj.update(),obj.removeIfOutsideBoundary&&(cont.x+obj.x+obj.areaRect.x+obj.areaRect.width<this._screenFocusPoint.x+this._activeBoundary.x||cont.x+obj.x>this._screenFocusPoint.x+this._activeBoundary.x+this._activeBoundary.width)&&this.removeObjectFromLayer(obj,i),obj.removeMe&&this.removeObjectFromLayer(obj,i);for(var c=0;c<this._collisions.length;c++)2==this._collisions[c].length&&this._collisions[c][0]==obj.type&&this._checkForCollisions(obj,cont,this._collisions[c][1])}},World.prototype.addLayer=function(name,parallax){parallax=parallax||new PIXI.Point(1,1);var container=new PIXI.Container;this.addChild(container),this._layers[name]={container:container,objects:[],parallax:parallax},this._camera.addLayer(name,container,parallax)},World.prototype.addObjectToLayer=function(obj,layerName,xPosition,yPosition){this._layers[layerName].container.addChild(obj),obj.x=xPosition,obj.y=yPosition,this._layers[layerName].objects.push(obj),obj.tintable&&obj.setTint(this.currentTint)},World.prototype.removeObjectFromLayer=function(obj,layerName){var placeInArray;if(null==layerName)for(var i in this._layers){placeInArray=this._layers[i].objects.indexOf(obj),layerName=i;break}this._layers[layerName].container.removeChild(obj),null==placeInArray&&(placeInArray=this._layers[layerName].objects.indexOf(obj)),placeInArray>-1&&this._layers[layerName].objects.splice(placeInArray,1),obj.dispose()},World.prototype.addCollisionDetector=function(object1Type,object2Type){this._collisions.push([object1Type,object2Type])},World.prototype.getLayerContainer=function(layerName){return this._layers[layerName].container},World.prototype.getLayerParallax=function(layerName){return this._layers[layerName].parallax},World.prototype.getAllObjectIds=function(){var ret={};for(var i in this._layers)for(var j=(this._layers[i].container,0);j<this._layers[i].objects.length;j++){var obj=this._layers[i].objects[j];void 0!=obj.id&&(ret[obj.id]=obj.type)}return ret},World.prototype.getObjectPositionOnScreen=function(obj){var ret=new PIXI.Point(this.x+obj.parent.x+obj.x,this.y+obj.parent.y+obj.y);return ret},World.prototype.getAllObjectsOfType=function(type){var ret=[];for(var i in this._layers)for(var j=(this._layers[i].container,0);j<this._layers[i].objects.length;j++)this._layers[i].objects[j].type==type&&ret.push(this._layers[i].objects[j]);return ret},World.prototype.setLocation=function(x,y){this._view.x=x+this._screenFocusPoint.x,this._view.y=y+this._screenFocusPoint.y,this._camera.update(),this.update();
},World.prototype.tintLayers=function(tint){this.currentTint=tint;for(var i in this._layers)for(var j=0;j<this._layers[i].objects.length;j++)this._layers[i].objects[j].tintable&&this._layers[i].objects[j].setTint(this.currentTint)},World.prototype.pause=function(){for(var i in this._layers)for(var j=0;j<this._layers[i].objects.length;j++){var obj=this._layers[i].objects[j];obj.pause&&obj.pause()}},World.prototype.resume=function(){for(var i in this._layers)for(var j=0;j<this._layers[i].objects.length;j++){var obj=this._layers[i].objects[j];obj.resume&&obj.resume()}},World.prototype._checkForCollisions=function(obj1,obj1Cont,collidingType){for(var i in this._layers)for(var obj2Cont=this._layers[i].container,j=0;j<this._layers[i].objects.length;j++)if(this._layers[i].objects[j].type==collidingType){var obj2=this._layers[i].objects[j],r1Left=obj1Cont.x+obj1.x+obj1.collisionRect.x,r2Left=obj2Cont.x+obj2.x+obj2.collisionRect.x,r1Right=r1Left+obj1.collisionRect.width,r2Right=r2Left+obj2.collisionRect.width,r1Top=obj1Cont.y+obj1.y+obj1.collisionRect.y,r2Top=obj2Cont.y+obj2.y+obj2.collisionRect.y,r1Bottom=r1Top+obj1.collisionRect.height,r2Bottom=r2Top+obj2.collisionRect.height,collision=!0;r2Top>r1Bottom&&(collision=!1),r1Top>r2Bottom&&(collision=!1),r2Left>r1Right&&(collision=!1),r1Left>r2Right&&(collision=!1),collision&&this.signals.collisionFired.dispatch(obj1,obj2)}},Object.defineProperty(World.prototype,"viewX",{get:function(){return this._view.x},set:function(value){return this._view.x=value+this._screenFocusPoint.x,this._camera.update(),this._view.x}}),Object.defineProperty(World.prototype,"viewY",{get:function(){return this._view.y},set:function(value){return this._view.y=this._view.y+(value+this._screenFocusPoint.y-this._view.y)*this.cameraDelay,this._camera.update(),this._view.y}}),Object.defineProperty(World.prototype,"activeBoundary",{get:function(){return this._activeBoundary},set:function(value){return this._activeBoundary=value,this._activeBoundary}}),Object.defineProperty(World.prototype,"viewBoundary",{get:function(){return this._viewBoundary},set:function(value){return this._viewBoundary=value,this._viewBoundary}}),Object.defineProperty(World.prototype,"screenFocusPoint",{get:function(){return this._screenFocusPoint},set:function(value){return this._screenFocusPoint=value,this._screenFocusPoint}})},{"../Common":3}],17:[function(require,module,exports){function Emitter(){}var Common=require("../Common");module.exports=Emitter,Emitter.add=function(parent,textures,json,x,y,removeTime,autoEmit,destroyTime){void 0==autoEmit&&(autoEmit=!0),void 0==destroyTime&&(destroyTime=1),x=x||0,y=y||0;for(var assetManager=p3.AssetManager.instance,i=0;i<textures.length;i++)textures[i]=assetManager.getTexture(textures[i]);var emitter=new cloudkid.Emitter(parent,textures,assetManager.getJSON(json));return autoEmit?emitter.emit=!0:emitter.emit=!1,emitter.updateOwnerPos(x,y),Common.animator.add(emitter),null!=removeTime&&Common.animator.setTimeout(function(){Emitter.destroy(emitter,destroyTime)},removeTime,this),emitter},Emitter.destroy=function(emitter,destroyDelay){null!=emitter&&(destroyDelay=destroyDelay||0,emitter.emit=!1,Common.animator.setTimeout(function(){Common.animator.remove(emitter),emitter.destroy()},destroyDelay,this))}},{"../Common":3}],18:[function(require,module,exports){function SoundSFX(){}var Common=require("../Common");module.exports=SoundSFX,SoundSFX.button=function(button,enableClickSound,enableOverSound){enableClickSound=void 0==enableClickSound?!0:enableClickSound,enableOverSound=void 0==enableOverSound?!0:enableOverSound,enableClickSound&&button.signals.click.add(function(button){p3.AudioManager.instance.playSound("sfx_btn_press_reverb")},this),enableOverSound&&button.signals.over.add(function(button){p3.AudioManager.instance.playSound("sfx_btn_rollover_reverb")},this)},SoundSFX.play=function(sound,params,delay){return 0==p3.AssetManager.instance.getJSON("config_data").enable_vo&&sound.indexOf("vo_")>-1?null:null==delay?p3.AudioManager.instance.playSound(sound,params):void setTimeout(function(){p3.AudioManager.instance.playSound(sound,params)},delay)},SoundSFX.playMusic=function(sound,params,delay){null==delay?p3.AudioManager.instance.playMusic(sound,params):Common.animator.setTimeout(function(){p3.AudioManager.instance.playMusic(sound,params)},delay/1e3,this)},SoundSFX.stop=function(sound){for(var currentSounds=p3.AudioManager.instance.soundsSFX,i=0;i<currentSounds.length;i++)currentSounds[i].name==sound&&p3.AudioManager.instance.stopSound(sound)},SoundSFX.playRandomFrom=function(sounds){var sound=sounds[Math.floor(Math.random()*sounds.length)];return 0==p3.AssetManager.instance.getJSON("config_data").enable_vo&&sound.indexOf("vo_")>-1?null:void p3.AudioManager.instance.playSound(sound)},SoundSFX.isSoundPlaying=function(sound){for(var currentSounds=p3.AudioManager.instance.soundsSFX,i=0;i<currentSounds.length;i++)if(currentSounds[i].name==sound)return!0;return!1},SoundSFX.stopAllVO=function(){for(var currentSounds=p3.AudioManager.instance.soundsSFX,i=currentSounds.length-1;i>=0;i--)currentSounds[i].name.indexOf("vo_")>-1&&(p3.AudioManager.instance.stopSound(currentSounds[i].name),currentSounds.splice(i,1))},SoundSFX.playVO=function(priority,sound,params,delay){if(0==p3.AssetManager.instance.getJSON("config_data").enable_vo)return null;if("high"==priority)this.stopAllVO(),this.play(sound,params,delay);else if("low"==priority){for(var isVOPlaying=!1,currentSounds=p3.AudioManager.instance.soundsSFX,i=0;i<currentSounds.length;i++)currentSounds[i].name.indexOf("vo_")>-1&&(isVOPlaying=!0);isVOPlaying||this.play(sound,params,delay)}},SoundSFX.playRandomVOFrom=function(priority,sounds){var sound=sounds[Math.floor(Math.random()*sounds.length)];this.playVO(priority,sound)}},{"../Common":3}],19:[function(require,module,exports){function TextItem(copy){this._assetManager=p3.AssetManager.instance,this._copyData=this._assetManager.getJSON("copy"),this._configData=this._assetManager.getJSON("config_data"),this._copy=copy,this._text=null,PIXI.Container.call(this),this.init()}require("../Common");module.exports=TextItem,TextItem.prototype=Object.create(PIXI.Container.prototype),TextItem.prototype.constructor=TextItem,TextItem.prototype.init=function(){var props={};for(var i in this._configData.default_format)props[i]=this._configData.default_format[i];var data=this.readCopy(this._copy);if(null!=data&&null!=data.format)for(var i in data.format)"offset"!=i&&"alignVertical"!=i&&(props[i]=data.format[i]);props.fill=Number(props.fill),this._text=new PIXI.Text(null!=data?data.copy:this._copy,props),this.addChild(this._text),"center"==props.align?this._text.anchor.x=.5:"right"==props.align&&(this._text.anchor.x=1),null!=data&&data.format&&(data.format.offset&&(this._text.x=data.format.offset.x||0,this._text.y=data.format.offset.y||0),data.format.alignVertical&&("center"==data.format.alignVertical?this._text.anchor.y=.5:"bottom"==data.format.alignVertical&&(this._text.anchor.y=1)))},TextItem.prototype.dispose=function(){},TextItem.prototype.readCopy=function(text){return void 0!=this._copyData.copy[text]?this._copyData.copy[text]:null},TextItem.prototype.changeFormat=function(format){var newFormat={},data=this.readCopy(this._copy);if(data.format)for(var i in data.format)newFormat[i]=data.format[i];for(var i in format)newFormat[i]=format[i];this._text.style=newFormat},Object.defineProperty(TextItem.prototype,"copy",{set:function(text){this._copy=text;var data=this.readCopy(text);this._text.text=null!=data?data.copy:text}})},{"../Common":3}],20:[function(require,module,exports){function FadeTransition(color,duration){this._color=color||0,this._duration=duration||.8,this._quad=null,Transition.call(this)}var Transition=(require("../Common"),require("./Transition"));module.exports=FadeTransition,FadeTransition.prototype=Object.create(Transition.prototype),FadeTransition.prototype.constructor=FadeTransition,FadeTransition.prototype.init=function(){this._quad=new PIXI.Graphics,this._quad.visible=!1,this._quad.beginFill(this._color),this._quad.drawRect(0,0,p3.View.width,p3.View.height),this._quad.endFill(),this.addChild(this._quad)},FadeTransition.prototype["in"]=function(){this._quad.alpha=0,this._quad.visible=!0,TweenMax.to(this._quad,.5*this._duration,{alpha:1,ease:Power2.easeInOut,onComplete:function(){Transition.prototype["in"].call(this,this)},onCompleteScope:this})},FadeTransition.prototype.out=function(){TweenMax.to(this._quad,.5*this._duration,{alpha:0,ease:Power2.easeInOut,onComplete:function(){this._quad.visible=!1,Transition.prototype.out.call(this,this)},onCompleteScope:this})},FadeTransition.prototype.resize=function(){this._quad.clear(),this._quad.beginFill(this._color),this._quad.drawRect(0,0,p3.View.width,p3.View.height),this._quad.endFill()}},{"../Common":3,"./Transition":23}],21:[function(require,module,exports){function Scene(){this.signals={},this.signals.next=new signals.Signal,this.signals.previous=new signals.Signal,this.signals.home=new signals.Signal,this.signals.pause=new signals.Signal,PIXI.Container.call(this)}module.exports=Scene,Scene.prototype=Object.create(PIXI.Container.prototype),Scene.prototype.constructor=Scene,Scene.prototype.init=function(){},Scene.prototype.dispose=function(){this.signals.next.dispose(),this.signals.previous.dispose(),this.signals.home.dispose(),this.signals.pause.dispose(),this.removeChildren()},Scene.prototype.resize=function(){},Scene.prototype.update=function(){},Scene.prototype.appear=function(){this.animateIn()},Scene.prototype.show=function(){this.animateIn()},Scene.prototype.hide=function(){},Scene.prototype.animateIn=function(callback,scope){scope=scope||window,callback&&callback.call(scope)},Scene.prototype.animateOut=function(callback,scope){scope=scope||window,callback&&callback.call(scope)}},{}],22:[function(require,module,exports){function SceneManager(){this._stage=null,this._renderer=null,this._stack=[],this._transition=null}var Transition=(require("./Scene"),require("./Transition"));module.exports=SceneManager,SceneManager.prototype.init=function(stage,renderer){this._stage=stage,this._renderer=renderer},SceneManager.prototype.update=function(){this._stack.length&&this.top.update()},SceneManager.prototype.add=function(scene,transition){function swap(scene){if(this.top)if(this.top.hide(),this._transition.push){if(this._transition.replace)for(var temp,i=0;i<this._stack.length;++i)temp=this._stack[i],temp.parent&&temp.parent.removeChild(temp)}else for(;this.top;)this.top.parent&&this.top.parent.removeChild(this.top),this.top.dispose(),this._stack.pop();scene.init(),scene.resize(),scene.parent||this.stage.addChildAt(scene,this._transition.parent.getChildIndex(this._transition)),this._stack.push(scene),this._transition.wait||p3.Timestep.queueCall(scene.appear,null,scene),this._transition.out(),console.log(this._stack)}this.transitionInProgress||(this._transition=transition||new Transition,!this._transition.requiresWebGL||this._renderer instanceof PIXI.WebGLRenderer||(this._transition=transition.fallback(),this._transition.push=transition.push,this._transition.replace=transition.replace,this._transition.wait=transition.wait),this._transition.init(),this._stage.addChild(this._transition),this._transition.signals["in"].addOnce(function(transition){p3.Timestep.queueCall(swap,[scene],this)},this),this._transition.signals.out.addOnce(function(transition){this._transition=null,transition.parent.removeChild(transition),transition.dispose(),transition.wait&&p3.Timestep.queueCall(scene.appear,null,scene)},this),this._transition["in"]())},SceneManager.prototype.remove=function(transition,count){function swap(count){for(var i=0;count>i;++i)this.top.hide(),this.top.parent&&this.top.parent.removeChild(this.top),this.top.dispose(),this._stack.pop();var scene=this.top;scene.resize(),scene.parent||this.stage.addChildAt(scene,this._transition.parent.getChildIndex(this._transition)),this._transition.wait||scene.show(),this._transition.out(),console.log(this._stack)}this.transitionInProgress||(this._transition=transition||new Transition,count=Math.max(1,count)||1,!this._transition.requiresWebGL||this._renderer instanceof PIXI.WebGLRenderer||(this._transition=transition.fallback(),this._transition.push=transition.push,this._transition.replace=transition.replace,this._transition.wait=transition.wait),this._transition.init(),this._stage.addChild(this._transition),this._transition.signals["in"].addOnce(function(transition){p3.Timestep.queueCall(swap,[count],this)},this),this._transition.signals.out.addOnce(function(transition){this._transition=null,transition.parent.removeChild(transition),transition.dispose(),transition.wait&&this.top.show()},this),this._transition["in"]())},SceneManager.prototype.clear=function(){},SceneManager.prototype.resize=function(){for(var scene,i=0;i<this._stack.length;++i)scene=this._stack[i],scene.resize();this._transition&&this._transition.resize()},Object.defineProperty(SceneManager.prototype,"stage",{get:function(){return this._stage}}),Object.defineProperty(SceneManager.prototype,"top",{get:function(){return this._stack.length?this._stack[this._stack.length-1]:null}}),Object.defineProperty(SceneManager.prototype,"transitionInProgress",{get:function(){return null!=this._transition?!0:!1}})},{"./Scene":21,"./Transition":23}],23:[function(require,module,exports){function Transition(){this.signals={},this.signals["in"]=new signals.Signal,this.signals.out=new signals.Signal,this.push=!1,this.replace=!0,this.wait=!0,this.requiresWebGL=!1,PIXI.Container.call(this)}module.exports=Transition,Transition.prototype=Object.create(PIXI.Container.prototype),Transition.prototype.constructor=Transition,Transition.prototype.init=function(){},Transition.prototype.dispose=function(){this.signals["in"].dispose(),this.signals.out.dispose(),this.removeChildren()},Transition.prototype["in"]=function(){this.signals["in"].dispatch(this)},Transition.prototype.out=function(){this.signals.out.dispatch(this)},Transition.prototype.resize=function(){},Transition.prototype.fallback=function(){}},{}],24:[function(require,module,exports){function AppOverlay(){this._overlay=null,this._panel=null,this._contents=null,this._appstore=null,this._amazon=null,this._google=null,this._appstoreLink=null,this._amazonLink=null,this._googleLink=null,this._buttonClicked=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("../screens/SimpleScreen"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=AppOverlay,AppOverlay.prototype=Object.create(SimpleScreen.prototype),AppOverlay.prototype.constructor=AppOverlay,AppOverlay.prototype.init=function(){console.log("PAUSE INITIALIZED");var configData=this._assetManager.getJSON("config_data");this._appstoreLink=configData.app_button.app_store_link,this._amazonLink=configData.app_button.amazon_link,this._googleLink=configData.app_button.google_link,this._appstoreLive=configData.app_button.app_store_live,this._amazonLive=configData.app_button.amazon_live,this._googleLive=configData.app_button.google_live,this._overlay=new PIXI.Sprite(Common.generatedTextures.blackSquare),this._overlay.alpha=.7,this._overlay.width=Common.STAGE_WIDTH,this._overlay.height=Common.STAGE_HEIGHT,this._overlay.hitArea=new PIXI.Rectangle(0,0,Common.STAGE_WIDTH,Common.STAGE_HEIGHT),this._overlay.interactive=!0,this.addChild(this._overlay),this._panel=new PIXI.Sprite(this._assetManager.getTexture("pop_up_pannel")),this._panel.anchor=new PIXI.Point(.5,.5),this._panel.x=Common.STAGE_WIDTH/2,this._panel.y=Common.STAGE_HEIGHT/2,this.addChild(this._panel);var appIcon=new PIXI.Sprite(this._assetManager.getTexture("app_icon"));appIcon.anchor=new PIXI.Point(.5,.5),appIcon.x=-260,appIcon.y=-45,this._panel.addChild(appIcon);var descriptionText=new TextItem("APP_DESCRIPTION");descriptionText.x=-129,descriptionText.y=-125,this._panel.addChild(descriptionText);var permissionText=new TextItem("APP_PARENT_PERMISSION");permissionText.x=-129,permissionText.y=descriptionText.y+descriptionText.height+30,this._panel.addChild(permissionText);var buttons=[];this._appstore=new p3.Button(this._assetManager.getTexture("btn_itunes")),this._appstore.x=-220,this._appstore.y=100,this._appstore.animate=!1,this._appstore.id="appstore",this._appstore.signals.down.add(this.onLinkClick,this),this._appstoreLive&&(this._panel.addChild(this._appstore),buttons.push(this._appstore)),this._amazon=new p3.Button(this._assetManager.getTexture("btn_amazon")),this._amazon.x=0,this._amazon.y=100,this._amazon.animate=!1,this._amazon.id="amazon",this._amazon.signals.down.add(this.onLinkClick,this),this._amazonLive&&(this._panel.addChild(this._amazon),buttons.push(this._amazon)),this._android=new p3.Button(this._assetManager.getTexture("btn_android")),this._android.x=220,this._android.y=100,this._android.animate=!1,this._android.id="google",this._android.signals.down.add(this.onLinkClick,this),this._googleLive&&(this._panel.addChild(this._android),buttons.push(this._android)),this._closeButton=new p3.Button(this._assetManager.getTexture("btn_close")),this._closeButton.x=this._panel.width/2-20,this._closeButton.y=-(this._panel.height/2)+20,this._closeButton.animate=!0,this._closeButton.signals.down.addOnce(this.onClose,this),this._panel.addChild(this._closeButton),this._panel.scale=new PIXI.Point(0,0);for(var xs3=[-220,0,220],xs2=[-130,130],xs1=[0],i=0;i<buttons.length;i++){var arr=xs3;2==buttons.length?arr=xs2:1==buttons.length&&(arr=xs1),buttons[i].x=arr[i]}SimpleScreen.prototype.init.call(this),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_popup"))},AppOverlay.prototype.update=function(){},AppOverlay.prototype.resize=function(){SimpleScreen.prototype.resize.call(this)},AppOverlay.prototype.dispose=function(){},AppOverlay.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this),Common.animator.add(TweenMax.to(this._panel.scale,.5,{x:1,y:1,ease:Back.easeOut}))},AppOverlay.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},AppOverlay.prototype.showWarning=function(){if(null==this._warningPanel){var panel=new PIXI.Sprite(this._assetManager.getTexture("pop_up_pannel_2"));panel.anchor=new PIXI.Point(.5,.5),panel.scale=new PIXI.Point(0,0),panel.x=Common.STAGE_WIDTH/2,panel.y=Common.STAGE_HEIGHT/2,this.addChild(panel);var title=new TextItem("APP_ARE_YOU_SURE");title.y=-200,panel.addChild(title);var text1=new TextItem("APP_DISCLAIMER_1");text1.y=title.y+title.height+30,panel.addChild(text1);var text2=new TextItem("APP_DISCLAIMER_2");text2.y=text1.y+text1.height+20,panel.addChild(text2),this._warningPanel=panel;var yesText=new TextItem("APP_CONTINUE"),noText=new TextItem("APP_GO_BACK"),defaultBut=new PIXI.Sprite(this._assetManager.getTexture("pop_up_btn_yes_off"));defaultBut.anchor=new PIXI.Point(.5,.5);var overBut=new PIXI.Sprite(this._assetManager.getTexture("pop_up_btn_yes_over"));overBut.anchor=new PIXI.Point(.5,.5),defaultBut.addChild(yesText);var yesTextureDef=defaultBut.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR);defaultBut.removeChild(yesText),defaultBut.addChild(noText);var noTextureDef=defaultBut.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR);yesText.changeFormat({fill:16777215}),noText.changeFormat({fill:16777215}),overBut.addChild(yesText);var yesTextureOver=overBut.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR);overBut.removeChild(yesText),overBut.addChild(noText);var noTextureOver=overBut.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),yesButton=new p3.Button(yesTextureDef,yesTextureOver);if(yesButton.y=150,yesButton.x=170,yesButton.animate=!0,p3.Device.isMobile){$("body").append('<a id="linkButtonA" target="_top" href="'+this["_"+this._buttonClicked+"Link"]+'">                                <div id="linkButtonDiv" style="position:absolute; left:50%; top:50%; width:35%; height:35%; background-color:#FFFFFF; z-index:100000; opacity:0; filter:alpha(opacity=1);"></div>                            </a>');var that=this;$("#linkButtonDiv").on("click",function(){that.onLinkAccept(),$("#linkButtonA").remove()})}else yesButton.signals.down.addOnce(this.onLinkAccept,this);panel.addChild(yesButton);var noButton=new p3.Button(noTextureDef,noTextureOver);noButton.y=150,noButton.x=-170,noButton.animate=!0,noButton.signals.down.addOnce(this.onLinkDecline,this),panel.addChild(noButton),Common.animator.add(TweenMax.to(panel.scale,.5,{x:1,y:1,ease:Back.easeOut}))}},AppOverlay.prototype.closeWarning=function(){null!=this._warningPanel&&Common.animator.add(TweenMax.to(this._warningPanel.scale,.5,{x:0,y:0,ease:Back.easeIn,onCompleteScope:this,onComplete:function(){this.removeChild(this._warningPanel),this._warningPanel=null}}))},AppOverlay.prototype.onClose=function(){this.signals.requestedPreviousScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_back")},AppOverlay.prototype.onLinkClick=function(button){this._buttonClicked=button.id;var id=button.id;"appstore"==id&&(id="iOS"),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_"+id+"_clicked")),this.showWarning()},AppOverlay.prototype.onLinkAccept=function(){p3.Device.isMobile||(console.log("desktop"),window.open(this["_"+this._buttonClicked+"Link"])),this.closeWarning();var id=this._buttonClicked;"appstore"==id&&(id="iOS"),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_leave_accept_"+id))},AppOverlay.prototype.onLinkDecline=function(){this.closeWarning();var id=this._buttonClicked;"appstore"==id&&(id="iOS"),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_leave_back_"+id)),$("#linkButtonA").remove()}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"../screens/SimpleScreen":33}],25:[function(require,module,exports){function HelpOverlay(){this._overlay=null,this._panel=null,this._title=null,this._resumeButton=null,this._retartButton=null,this._levelSelectButton=null,this._helpButton=null,this._slides=null,this._currentPage=0,this._pageIconHolder=null,this._pageIcons=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("../screens/SimpleScreen"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=HelpOverlay,HelpOverlay.prototype=Object.create(SimpleScreen.prototype),HelpOverlay.prototype.constructor=HelpOverlay,HelpOverlay.prototype.init=function(){console.log("PAUSE INITIALIZED"),this._panel=new PIXI.Sprite(this._assetManager.getTexture("help_panel")),this._panel.anchor=new PIXI.Point(.5,.5),this._panel.x=Common.STAGE_WIDTH/2,this._panel.y=Common.STAGE_HEIGHT/2,this._panel.scale=new PIXI.Point(0,0),this.addChild(this._panel),this._title=new PIXI.Sprite(this._assetManager.getTexture("help_title")),this._title.anchor=new PIXI.Point(.5,.5),this._title.y=-250,this._panel.addChild(this._title),this._exitButton=new p3.Button(this._assetManager.getTexture("btn_back")),this._exitButton.y=this._guiButtonTopMargin,this._exitButton.animate=!0,this._exitButton.signals.down.addOnce(this.onExit,this),this.addChild(this._exitButton),this._addMuteButton(),this._slides=[];var screen1=new PIXI.Sprite(this._assetManager.getTexture("help_screen_1"));screen1.anchor=new PIXI.Point(.5,.5);var text=new TextItem("INSTRUCTIONS_RUN");text.y=-100,screen1.addChild(text);var screen1Texture=screen1.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),screen2=new PIXI.Sprite(this._assetManager.getTexture("help_screen_2"));screen2.anchor=new PIXI.Point(.5,.5);var text=new TextItem("INSTRUCTIONS_JUMP");text.y=-180,screen2.addChild(text);var screen2Texture=screen2.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),screen3=new PIXI.Sprite(this._assetManager.getTexture("help_screen_3"));screen3.anchor=new PIXI.Point(.5,.5);var text=new TextItem("INSTRUCTIONS_COLLECTIBLES");text.x=-130,text.y=-130,screen3.addChild(text);var text=new TextItem("INSTRUCTIONS_ROAR_TOKENS");text.x=-130,text.y=30,screen3.addChild(text);var screen3Texture=screen3.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),screen4=new PIXI.Sprite(this._assetManager.getTexture("help_screen_4"));screen4.anchor=new PIXI.Point(.5,.5);var text=new TextItem("INSTRUCTIONS_OBSTACLES");text.y=-175,screen4.addChild(text);var screen4Texture=screen4.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),screen5=new PIXI.Sprite(this._assetManager.getTexture("help_screen_5"));screen5.anchor=new PIXI.Point(.5,.5);var text=new TextItem("INSTRUCTIONS_FRIENDS");text.y=130,screen5.addChild(text);for(var screen5Texture=screen5.generateTexture(Common.renderer,1,PIXI.SCALE_MODES.LINEAR),images=[screen1Texture,screen2Texture,screen3Texture,screen4Texture,screen5Texture],i=0;i<images.length;i++){var image=new PIXI.Sprite(images[i]);image.anchor=new PIXI.Point(.5,.5),image.x=5,image.y=-7,this._slides.push(image),this._panel.addChild(image),i>0&&(image.alpha=0)}this._leftButton=new p3.Button(this._assetManager.getTexture(Common.LEFT_TO_RIGHT?"btn_left":"btn_right")),this._leftButton.x=-200,this._leftButton.y=220,this._leftButton.animate=!0,this._leftButton.signals.down.add(this.onLeftClick,this),this._panel.addChild(this._leftButton),this._rightButton=new p3.Button(this._assetManager.getTexture(Common.LEFT_TO_RIGHT?"btn_right":"btn_left")),this._rightButton.x=200,this._rightButton.y=220,this._rightButton.animate=!0,this._rightButton.signals.down.add(this.onRightClick,this),this._panel.addChild(this._rightButton),Common.LEFT_TO_RIGHT||(this._rightButton.x=-200,this._leftButton.x=200);var icons=["help_counter_1","help_counter_2","help_counter_3","help_counter_4","help_counter_5"];this._pageIcons=[],this._pageIconHolder=new PIXI.Container,this._pageIconHolder.y=220,this._pageIconHolder.touchstart=this._pageIconHolder.mousedown=this.onPageIconClick.bind(this),this._pageIconHolder.interactive=!0,this._pageIconHolder.buttonMode=!0,this._panel.addChild(this._pageIconHolder);for(var i=0;i<icons.length;i++){var page=new PIXI.Sprite(this._assetManager.getTexture(icons[i]));page.anchor=new PIXI.Point(.5,.5),this._pageIcons.push(page),this._pageIconHolder.addChild(page),i>0&&(page.visible=!1),Common.LEFT_TO_RIGHT||(page.scale.x=-1)}this.setPage(0),SimpleScreen.prototype.init.call(this)},HelpOverlay.prototype.update=function(){},HelpOverlay.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._muteButton.x=this._getFirstButtonPositionRight(),this._exitButton.x=this._getFirstButtonPositionLeft()},HelpOverlay.prototype.dispose=function(){},HelpOverlay.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this),Common.animator.add(TweenMax.to(this._panel.scale,.5,{x:1,y:1,ease:Back.easeOut}))},HelpOverlay.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},HelpOverlay.prototype.setPage=function(page){if(page>=0&&page<this._slides.length){this._currentPage=page;for(var i in this._slides)Common.animator.add(TweenMax.to(this._slides[i],.3,{alpha:0})),this._pageIcons[i].visible=!1;Common.animator.add(TweenMax.to(this._slides[this._currentPage],.3,{delay:.3,alpha:1})),this._pageIcons[this._currentPage].visible=!0}0==this._currentPage?Common.animator.add(TweenMax.to(this._leftButton,.3,{alpha:0})):Common.animator.add(TweenMax.to(this._leftButton,.3,{alpha:1})),this._currentPage==this._slides.length-1?Common.animator.add(TweenMax.to(this._rightButton,.3,{alpha:0})):Common.animator.add(TweenMax.to(this._rightButton,.3,{alpha:1}))},HelpOverlay.prototype.showFinger=function(){this._tutorialFinger.scale.y=1,this._tutorialFinger.alpha=0,TweenMax.killTweensOf(this._tutorialFinger);var tl=new TimelineMax;Common.animator.add(tl),tl.to(this._tutorialFinger,.3,{alpha:1},0),tl.to(this._tutorialFinger.scale,.5,{y:.7,ease:Sine.easeInOut}),tl.to(this._tutorialFinger.scale,.8,{y:1,ease:Elastic.easeOut}),tl.to(this._tutorialFinger,.3,{alpha:0}),tl.to(this._tutorialBurst.scale,.5,{x:1,y:1,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._tutorialBurst.scale=new PIXI.Point(0,0)}},.8)},HelpOverlay.prototype.onExit=function(){this.signals.requestedPreviousScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_back")},HelpOverlay.prototype.onPageIconClick=function(event){var point=event.data.getLocalPosition(this._pageIconHolder);point.x>-90&&point.x<-57?this.setPage(0):point.x>=-57&&point.x<-19?this.setPage(1):point.x>=-19&&point.x<19?this.setPage(2):point.x>=19&&point.x<57?this.setPage(3):point.x>=57&&point.x<90&&this.setPage(4)},HelpOverlay.prototype.onLeftClick=function(){this.setPage(this._currentPage-1),SoundSFX.play("sfx_tlg_ui_generalselect")},HelpOverlay.prototype.onRightClick=function(){this.setPage(this._currentPage+1),SoundSFX.play("sfx_tlg_ui_generalselect")}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"../screens/SimpleScreen":33}],26:[function(require,module,exports){function PauseOverlay(){this._overlay=null,this._panel=null,this._title=null,this._resumeButton=null,this._retartButton=null,this._levelSelectButton=null,this._helpButton=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("../screens/SimpleScreen"),SoundSFX=require("../general/SoundSFX");module.exports=PauseOverlay,PauseOverlay.prototype=Object.create(SimpleScreen.prototype),PauseOverlay.prototype.constructor=PauseOverlay,PauseOverlay.prototype.init=function(){console.log("PAUSE INITIALIZED"),this._overlay=new PIXI.Sprite(Common.generatedTextures.blackSquare),this._overlay.alpha=.7,this._overlay.width=Common.STAGE_WIDTH,this._overlay.height=Common.STAGE_HEIGHT,this._overlay.hitArea=new PIXI.Rectangle(0,0,Common.STAGE_WIDTH,Common.STAGE_HEIGHT),this._overlay.interactive=!0,this.addChild(this._overlay),this._panel=new PIXI.Sprite(this._assetManager.getTexture("paused_panel")),this._panel.anchor=new PIXI.Point(.5,.5),this._panel.x=Common.STAGE_WIDTH/2,this._panel.y=Common.STAGE_HEIGHT/2,this.addChild(this._panel),this._panel.scale=new PIXI.Point(0,0),this._title=new PIXI.Sprite(this._assetManager.getTexture("paused_title")),this._title.anchor=new PIXI.Point(.5,.5),this._title.y=-250,this._panel.addChild(this._title),this._resumeButton=new p3.Button(this._assetManager.getTexture("btn_play")),this._resumeButton.x=0,this._resumeButton.y=-80,this._resumeButton.animate=!0,this._resumeButton.signals.down.addOnce(this.onClose,this),this._panel.addChild(this._resumeButton),this._levelSelectButton=new p3.Button(this._assetManager.getTexture("btn_home_large")),this._levelSelectButton.x=-220,this._levelSelectButton.y=100,this._levelSelectButton.animate=!0,this._levelSelectButton.signals.down.addOnce(this.onHome,this),this._panel.addChild(this._levelSelectButton),this._restartButton=new p3.Button(this._assetManager.getTexture("btn_replay_large")),this._restartButton.x=0,this._restartButton.y=100,this._restartButton.animate=!0,this._restartButton.signals.down.addOnce(this.onRestart,this),this._panel.addChild(this._restartButton),this._helpButton=new p3.Button(this._assetManager.getTexture("btn_help_large")),this._helpButton.x=220,this._helpButton.y=100,this._helpButton.animate=!0,this._helpButton.signals.down.add(this.onHelp,this),this._panel.addChild(this._helpButton),this._addMuteButton(),SimpleScreen.prototype.init.call(this)},PauseOverlay.prototype.update=function(){},PauseOverlay.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._muteButton.x=this._getFirstButtonPositionRight()},PauseOverlay.prototype.dispose=function(){},PauseOverlay.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this),Common.animator.add(TweenMax.to(this._panel.scale,.5,{x:1,y:1,ease:Back.easeOut}))},PauseOverlay.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},PauseOverlay.prototype.hideGUI=function(){this._panel.visible=!1,this._muteButton.visible=!1},PauseOverlay.prototype.showGUI=function(){this._panel.visible=!0,
this.removeChild(this._muteButton),this._muteButton.dispose(),this._addMuteButton(),this._muteButton.x=this._getFirstButtonPositionRight()},PauseOverlay.prototype.onClose=function(){this.signals.requestedPreviousScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_play")},PauseOverlay.prototype.onHome=function(){this.signals.requestedNextScreen.dispatch("home"),SoundSFX.play("sfx_tlg_ui_back")},PauseOverlay.prototype.onRestart=function(){this.signals.requestedNextScreen.dispatch("restart"),SoundSFX.play("sfx_tlg_ui_back")},PauseOverlay.prototype.onHelp=function(){this.signals.requestedHelpOverlay.dispatch(),SoundSFX.play("sfx_tlg_ui_generalselect")}},{"../Common":3,"../general/SoundSFX":18,"../screens/SimpleScreen":33}],27:[function(require,module,exports){function GameScreen(level){this._level=level,this._bgHolder=null,this._bg=null,this._skyHolder=null,this._sky=null,this._sun=null,this._roarCloud=null,this._avatar=null,this._avatarShadow=null,this._mapReader=null,this._world=null,this._paths=null,this._availableTokens=null,this._cameraBoundary=null,this._debugPaths=!1,this._gameUI=null,this._lives=5,this._tokens=0,this._paused=!1,this._cameraTracking=!0,this._speedLinesEmitter=null,this._sceneImagePool=null,SimpleScreen.call(this),this.signals.exit=new signals.Signal}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),Avatar=require("../game/Avatar"),World=require("../game/World"),MapReader=require("../game/MapReader"),Token=require("../game/Token"),Boulder1=require("../game/Boulder1"),Hole=require("../game/Hole"),Hyena=require("../game/Hyena"),RoarToken=require("../game/RoarToken"),HiddenCharacter=require("../game/HiddenCharacter"),SceneImage=require("../game/SceneImage"),BackgroundImage=require("../game/BackgroundImage"),GameUI=require("../game/GameUI"),Emitter=require("../general/Emitter"),SoundSFX=require("../general/SoundSFX");module.exports=GameScreen,GameScreen.prototype=Object.create(SimpleScreen.prototype),GameScreen.prototype.constructor=GameScreen,GameScreen.prototype.init=function(){console.log("GAME INITIALIZED"),SimpleScreen.prototype.init.call(this),this._createSky(),this._levelData=this._assetManager.getJSON("level_data"),this._mapReader=new MapReader(this._levelData.levels[this._level].data_id,5e3),this._cameraBoundary=new PIXI.Rectangle(0,200,Common.STAGE_WIDTH/2-200,300);var p=100;this._world=new World(new PIXI.Point(Common.STAGE_WIDTH/2,Common.STAGE_HEIGHT/2),new PIXI.Rectangle(-Common.STAGE_WIDTH/2,-Common.STAGE_HEIGHT/2,Common.STAGE_WIDTH,Common.STAGE_HEIGHT),new PIXI.Rectangle(-Common.STAGE_WIDTH-p,-(Common.STAGE_HEIGHT/2)-p,2.5*Common.STAGE_WIDTH+2*p,Common.STAGE_HEIGHT+2*p)),this._world.init(),this._sceneImagePool=new p3.ObjectPool(SceneImage,2,[]),this._world.viewX=-this._levelData.levels[this._level].start.x,this._world.viewY=this._levelData.levels[this._level].start.y,this._world.update(),this.addChild(this._world),this._createBackgroundLayers();for(var levelLayers=this._mapReader.getLevelLayers(),i=0;i<levelLayers.length;i++)this._world.addLayer(levelLayers[i],new PIXI.Point(1,1));this._world.addLayer("gameLayer",new PIXI.Point(1,1));for(var fgLayers=this._mapReader.getForegroundLayers(),i=0;i<fgLayers.length;i++)this._world.addLayer(fgLayers[i],new PIXI.Point(1,1));if(this._avatarShadow=new PIXI.Sprite(this._assetManager.getTexture("KionShadow")),this._avatarShadow.anchor=new PIXI.Point(.5,.2),this._world.addObjectToLayer(this._avatarShadow,"gameLayer",0,0),this._avatar=new Avatar,this._avatar.init(),this._avatar.signals.roarEnded.add(this.onRoarEnded,this),this._world.addObjectToLayer(this._avatar,"gameLayer",this._levelData.levels[this._level].start.x-1.2*this._world.screenFocusPoint.x,this._levelData.levels[this._level].start.y),this._paths=[],this._debugPaths){var graphic=new PIXI.Graphics;graphic.lineStyle(2,13357780),this._world.addObjectToLayer(graphic,"gameLayer",0,0)}for(var i=0;i<this._mapReader.paths.length;i++){var path=this._mapReader.paths[i];path.sort(function(a,b){return a.x-b.x});var startX=Math.min(path[0].x,path[1].x),startY=Math.min(path[0].y,path[1].y)-100,rectWidth=Math.abs(path[1].x-path[0].x),rectHeight=Math.abs(path[1].y-path[0].y)+200;this._paths.push({points:[{x:path[0].x,y:path[0].y},{x:path[1].x,y:path[1].y}],rect:new PIXI.Rectangle(startX,startY,rectWidth,rectHeight)})}this._paths.sort(function(a,b){return a.rect.x-b.rect.x});for(var i=0;i<this._paths.length;i++)if(this._paths[i].rect.y>this._levelData.levels[this._level].start.y){this._paths.splice(0,0,{points:[{x:this._paths[i].points[0].x-2e3,y:this._paths[i].points[0].y},{x:this._paths[i].points[0].x,y:this._paths[i].points[0].y}],rect:new PIXI.Rectangle(this._paths[i].points[0].x-2e3,this._paths[i].points[0].y,2e3,1)});break}if(this._debugPaths)for(var i in this._paths)graphic.moveTo(this._paths[i].points[0].x,this._paths[i].points[0].y),graphic.lineTo(this._paths[i].points[1].x,this._paths[i].points[1].y),graphic.drawRect(this._paths[i].rect.x,this._paths[i].rect.y,this._paths[i].rect.width,this._paths[i].rect.height);this._hitArea=new PIXI.Sprite(Common.generatedTextures.blackSquare),this._hitArea.alpha=0,this._hitArea.width=Common.STAGE_WIDTH,this._hitArea.height=Common.STAGE_HEIGHT,this._hitArea.hitArea=new PIXI.Rectangle(0,0,Common.STAGE_WIDTH,Common.STAGE_HEIGHT),this._hitArea.interactive=!0,this.addChild(this._hitArea),this._hitArea.touchstart=this._hitArea.mousedown=this.onTouchStart.bind(this),this._hitArea.touchend=this._hitArea.mouseup=this.onTouchEnd.bind(this),this._gameUI=new GameUI,this._gameUI.init(),this._gameUI.signals.roarIconClicked.add(this.onRoarIconClicked,this),this._gameUI.signals.roarActivated.add(this.onRoarActivated,this),this.addChild(this._gameUI),this._addMuteButton(),this._addPauseButton(),this._world.addCollisionDetector("avatar","token"),this._world.addCollisionDetector("avatar","boulder1"),this._world.addCollisionDetector("avatar","hyena"),this._world.addCollisionDetector("avatar","roarToken"),this._world.addCollisionDetector("avatar","hiddenCharacter"),this._world.addCollisionDetector("avatar","hole"),this._world.signals.collisionFired.add(this.onCollision,this),this._availableTokens=[],this._speedLinesEmitter=Emitter.add(this._world.getLayerContainer("gameLayer"),["speed-lines"],"particle_roar_speedlines",0,0,null,!1),SoundSFX.play("sfx_tlg_amb_grasslands_lp",{loop:!0}),SoundSFX.play("music_grasslands",{loop:!0}),0==this._level&&SoundSFX.play("vo_kion-2",null,3e3),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","started_level_"+(this._level+1)))},GameScreen.prototype.dispose=function(){SoundSFX.stop("sfx_tlg_amb_grasslands_lp"),SoundSFX.stop("music_grasslands"),SoundSFX.stop("music_grasslands_roar"),SoundSFX.stopAllVO(),Common.animator.removeAll()},GameScreen.prototype.update=function(){if(SimpleScreen.prototype.update.call(this),this._paused)return null;var prevViewX=this._world.viewX;this._world.viewY;this._avatar.update(),this._roarCloud.x=this._avatar.x*this._world.getLayerParallax("clouds").x+200;var targetY=null,shadowTargetY=null;if(this._avatar.allowPathCollisions){var yTargets=[],shadowTargets=[],padding=.2*this._avatar.collisionRect.height,avatarCollisionRect=new PIXI.Rectangle(this._avatar.x,this._avatar.y-this._avatar.collisionRect.height,0,this._avatar.collisionRect.height+padding);if(!this._avatar.grounded&&this._avatar.velocity.y>0){var diff=this._avatar.y-this._avatar.lastPosition.y;avatarCollisionRect.y-=diff,avatarCollisionRect.height+=diff}for(var i=0;i<this._paths.length;i++)if(this._paths[i].rect.x<avatarCollisionRect.x&&this._checkRectangleCollision(avatarCollisionRect,this._paths[i].rect)){var xp=(this._avatar.x-this._paths[i].points[0].x)/(this._paths[i].points[1].x-this._paths[i].points[0].x),thisY=this._paths[i].points[0].y+(this._paths[i].points[1].y-this._paths[i].points[0].y)*xp;avatarCollisionRect.y+avatarCollisionRect.height>thisY&&avatarCollisionRect.y<thisY?yTargets.push({y:thisY,points:this._paths[i].points}):shadowTargets.push({y:thisY,points:this._paths[i].points})}yTargets.length>1&&yTargets.sort(function(a,b){return a.y-b.y}.bind(this)),yTargets.length>0&&(targetY=yTargets[0]),shadowTargets.length>1&&shadowTargets.sort(function(a,b){return a.y-b.y}.bind(this)),shadowTargets.length>0&&(shadowTargetY=shadowTargets[0])}null!=targetY&&this._avatar.grounded?(this._avatar.y=targetY.y,this._avatar.setRotation(targetY.points[1].y,targetY.points[0].y,targetY.points[1].x,targetY.points[0].x)):null!=targetY&&!this._avatar.grounded&&this._avatar.velocity.y>0?(this._avatar.y=targetY.y,this._avatar.grounded=!0,this._avatar.setRotation(targetY.points[1].y,targetY.points[0].y,targetY.points[1].x,targetY.points[0].x)):null==targetY&&this._avatar.grounded&&(this._avatar.grounded=!1,this._avatar.setRotation(0,0,1,0));var shadowTargetY=targetY||shadowTargetY;if(null!=shadowTargetY?(this._avatarShadow.y=shadowTargetY.y,this._avatarShadow.x=this._avatar.x,this._avatarShadow.visible=!0,this._avatarShadow.alpha=1-Math.min(shadowTargetY.y-this._avatar.y,100)/100,this._avatar.grounded&&(this._avatarShadow.rotation=this._avatar.rotation)):this._avatarShadow.visible=!1,this._cameraTracking){this._world.getObjectPositionOnScreen(this._avatar).x>=this._cameraBoundary.x+this._cameraBoundary.width?(this._world.viewX=-this._avatar.x-(this._world.screenFocusPoint.x-(this._cameraBoundary.x+this._cameraBoundary.width)),this._world.cameraDelay=.2):this._world.cameraDelay=.15;var yDiff=this._avatar.y-this._world.viewY;this._world.screenFocusPoint.y+yDiff<this._cameraBoundary.y&&(this._world.viewY=-this._avatar.y-(this._world.screenFocusPoint.y-this._cameraBoundary.y)),this._world.screenFocusPoint.y+yDiff>=this._cameraBoundary.y+this._cameraBoundary.height&&(this._world.viewY=-this._avatar.y-(this._world.screenFocusPoint.y-(this._cameraBoundary.y+this._cameraBoundary.height)))}for(var min=-this._world.viewX-this._world.viewBoundary.width/2,max=-this._world.viewX+this._world.viewBoundary.width,mapObjects=this._mapReader.mapObjects(min,max),existingIds=this._world.getAllObjectIds(),i=0;i<mapObjects.length;i++)for(var j=0;j<mapObjects[i].length;j++)if(void 0==existingIds[mapObjects[i][j].id]&&mapObjects[i][j].x+mapObjects[i][j].areaRectX>min&&mapObjects[i][j].x+mapObjects[i][j].areaRectX<max){var obj=this.generateObject(mapObjects[i][j].type,mapObjects[i][j].data);if(null!=obj){if(obj.id=mapObjects[i][j].id,"image"==mapObjects[i][j].type){if("levelendmonolith"==mapObjects[i][j].data.image){this._world.addObjectToLayer(obj,"interactiveLayer",mapObjects[i][j].x,mapObjects[i][j].y);continue}}else"token"==mapObjects[i][j].type&&this._availableTokens.push(obj);this._world.addObjectToLayer(obj,mapObjects[i][j].layer,mapObjects[i][j].x,mapObjects[i][j].y)}}-this._levelData.levels[this._level].end_x+4e3<prevViewX&&-this._levelData.levels[this._level].end_x+4e3>=this._world.viewX&&SoundSFX.playVO("high","vo_encouragement_010_kion"),-this._levelData.levels[this._level].end_x+500<prevViewX&&-this._levelData.levels[this._level].end_x+500>=this._world.viewX&&(this._avatar.enableJump=!1,this._gameUI.hideRoar(),SoundSFX.play("music_grasslands_success"),SoundSFX.stop("music_grasslands"),SoundSFX.stop("music_grasslands_roar")),-this._levelData.levels[this._level].end_x<prevViewX&&-this._levelData.levels[this._level].end_x>=this._world.viewX&&this.completeLevel(),0==this._level&&prevViewX>-10200&&-10200>=this._world.viewX&&SoundSFX.playVO("high","vo_kion-3");for(var i=0;i<this._levelData.levels[this._level].tutorialFingerTriggers.length;i++){var triggerX=this._levelData.levels[this._level].tutorialFingerTriggers[i];prevViewX>-triggerX&&-triggerX>=this._world.viewX&&(this.pause(),this._gameUI.activateTutorialFinger(),this._avatar.enableJump=!0)}for(var avX=this._avatar.x,avY=this._avatar.y,i=this._availableTokens.length-1;i>=0;i--){if(this._avatar.dashing&&!this._availableTokens[i].magnet){var hyp=Math.sqrt(Math.pow(avX-this._availableTokens[i].x,2)+Math.pow(avY-this._availableTokens[i].y,2));300>hyp&&(this._availableTokens[i].magnet=!0)}this._availableTokens[i].magnet&&!this._availableTokens[i].hasBeenCollected&&(this._availableTokens[i].x=this._avatar.x+.9*(this._availableTokens[i].x-this._avatar.x),this._availableTokens[i].y=this._avatar.y+.9*(this._availableTokens[i].y-this._avatar.y),this._availableTokens[i].x+=this._avatar.x-this._avatar.lastPosition.x),this._availableTokens[i].removed&&this._availableTokens.splice(i,1)}if(this._avatar.dashing)for(var hyenas=this._world.getAllObjectsOfType("hyena"),i=0;i<hyenas.length;i++)hyenas[i].collided||hyenas[i].x<this._avatar.x+300&&(hyenas[i].hide(),SoundSFX.play("sfx_tlg_impact_hyena_01"));this._speedLinesEmitter.updateOwnerPos(this._avatar.x-30,this._avatar.y-30),this._world.update(),this._avatar.y>this._mapReader.lowestPathPoint+1e3&&this.signals.requestedPreviousScreen.dispatch()},GameScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._gameUI.resize(this._leftEdge,this._rightEdge),this._pauseButton.x=this._getSecondButtonPositionRight(),this._muteButton.x=this._getFirstButtonPositionRight()},GameScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},GameScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},GameScreen.prototype.generateObject=function(type,data){var obj=null;switch(type){case"beshtecelebrationidle00":case"bungacelebration01":case"fulicelebrationidle00":case"onoidle00":var characters={beshtecelebrationidle00:"beshte",bungacelebration01:"bunga",fulicelebrationidle00:"fuli",onoidle00:"ono"};obj=new HiddenCharacter(characters[type]),obj.init();break;case"hyena01-idle00":obj=new Hyena,obj.init();break;case"image":obj=this._sceneImagePool.create(),null==obj&&(this._sceneImagePool.expand(2),obj=this._sceneImagePool.create()),obj.create(data,this._sceneImagePool);break;case"m1holeback":obj=new Hole,obj.init();break;case"m1rockobstacle":obj=new Boulder1,obj.init();break;case"lion_coin":obj=new RoarToken,obj.init();break;case"token":obj=new Token,obj.init()}return obj},GameScreen.prototype.takeDamage=function(){this._lives--,0==this._lives?(Common.animator.setTimeout(function(){Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","fail_level_"+(this._level+1))),this.signals.requestedNextScreen.dispatch(!1)},.5,this),this._avatar.enableJump=!1):(this._gameUI.loseLife(this._lives),this.setSun())},GameScreen.prototype.completeLevel=function(){this._avatar.celebrate(),SoundSFX.playVO("low","vo_victoriouslaugh_011_kion"),this._speedLinesEmitter.emit=!1;var runTime=0==this._level?4:11;0==this._assetManager.getJSON("config_data").enable_vo&&(runTime=4),Common.animator.setTimeout(function(){this._cameraTracking=!1,this._avatar.run();var endChars=this._world.getAllObjectsOfType("hiddenCharacter");for(var i in endChars)endChars[i].run()},runTime,this),Common.animator.setTimeout(function(){this.signals.requestedNextScreen.dispatch(!0,this._tokens,this._levelData.levels[this._level].characters)},runTime+3,this),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","complete_level_"+(this._level+1)));var skipButton=new p3.Button(this._assetManager.getTexture("btn_next"));skipButton.y=Common.STAGE_HEIGHT-100,skipButton.x=Math.min(Common.STAGE_WIDTH/2+683-250,this._rightEdge-60),skipButton.animate=!0,skipButton.signals.down.add(function(){this.signals.requestedNextScreen.dispatch(!0,this._tokens,this._levelData.levels[this._level].characters)},this),this.addChild(skipButton),skipButton.scale=new PIXI.Point(0,0),Common.animator.add(TweenMax.to(skipButton.scale,.5,{x:1,y:1,ease:Back.easeOut}))},GameScreen.prototype.pause=function(){this._paused=!0,this._world.pause(),this._gameUI.pause(),TweenMax.pauseAll()},GameScreen.prototype.resume=function(){this._paused=!1,this._world.resume(),this._gameUI.resume(),TweenMax.resumeAll()},GameScreen.prototype.hideGUI=function(){this._hitArea.interactive=!1,this._gameUI.hideGUI()},GameScreen.prototype.showGUI=function(){this.removeChild(this._muteButton),this._muteButton.dispose(),this._addMuteButton(),this._muteButton.x=this._getFirstButtonPositionRight(),this._hitArea.interactive=!0,this._gameUI.showGUI()},GameScreen.prototype.setSun=function(){var positions=[{x:Common.STAGE_WIDTH/2+300,y:Common.STAGE_HEIGHT},{x:Common.STAGE_WIDTH/2+300,y:Common.STAGE_HEIGHT},{x:Common.STAGE_WIDTH/2+300,y:Common.STAGE_HEIGHT/2-100},{x:Common.STAGE_WIDTH/2+150,y:Common.STAGE_HEIGHT/4-50},{x:Common.STAGE_WIDTH/2,y:0}],pos=positions[this._lives-1];Common.animator.add(TweenMax.to(this._sun,2,{x:pos.x,y:pos.y,ease:Sine.easeInOut}));var skies=["sky_gradients_04","sky_gradients_03","sky_gradients_02","sky_gradients_01","sky_gradients_00"],newSky=new PIXI.Sprite(this._assetManager.getTexture(skies[this._lives-1]));newSky.alpha=0,newSky.width=Common.STAGE_WIDTH,newSky.y=153,this._skyHolder.addChild(newSky),Common.animator.add(TweenMax.to(newSky,.5,{alpha:1,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._skyHolder.removeChild(this._sky),this._sky=newSky}}));var colours=["purple","orange","yellow","darkYellow","blue"],newBg=new PIXI.Sprite(Common.generatedTextures[colours[this._lives-1]+"Square"]);newBg.alpha=0,newBg.width=Common.STAGE_WIDTH,newBg.height=Common.STAGE_HEIGHT,this._bgHolder.addChild(newBg),Common.animator.add(TweenMax.to(newBg,.5,{alpha:1,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._bgHolder.removeChild(this._bg),this._bg=newBg}}));var greys=[5066061,7566709,10330273,12633028,16777215];this._world.tintLayers(greys[this._lives-1]),1==this._lives&&SoundSFX.playVO("low","vo_timerunningout_010_kion",null,1500)},GameScreen.prototype._createSky=function(){this._bgHolder=new PIXI.Sprite,this.addChild(this._bgHolder),this._bg=new PIXI.Sprite(Common.generatedTextures.blueSquare),this._bg.width=Common.STAGE_WIDTH,this._bg.height=Common.STAGE_HEIGHT,this._bgHolder.addChild(this._bg),this._skyHolder=new PIXI.Sprite,this.addChild(this._skyHolder),this._sky=new PIXI.Sprite(this._assetManager.getTexture("sky_gradients_00")),this._sky.width=Common.STAGE_WIDTH,this._sky.y=153,this._skyHolder.addChild(this._sky),this._sun=new PIXI.Sprite(this._assetManager.getTexture("sky_sun")),this._sun.anchor=new PIXI.Point(.5,.5),this._sun.x=Common.STAGE_WIDTH/2,this._sun.y=0,this.addChild(this._sun)},GameScreen.prototype._checkRectangleCollision=function(rect1,rect2){var r1Left=rect1.x,r2Left=rect2.x,r1Right=rect1.x+rect1.width,r2Right=rect2.x+rect2.width,r1Top=rect1.y,r2Top=rect2.y,r1Bottom=rect1.y+rect1.height,r2Bottom=rect2.y+rect2.height;return r2Top>r1Bottom?!1:r1Top>r2Bottom?!1:r2Left>r1Right?!1:r1Left>r2Right?!1:!0},GameScreen.prototype._createBackgroundLayers=function(){var layers=[];layers.push({id:"clouds",image:"m1clouds",xSpeed:.08,y:-100,amount:4,scale:1}),layers.push({id:"mountains",image:"m1bg00",xSpeed:.05,y:-200,amount:11,scale:1}),layers.push({id:"farFields",image:"m1bg01",xSpeed:.07,y:106,amount:11,scale:2}),layers.push({id:"MidFields1",image:"m1bg02",xSpeed:.1,y:200,amount:15,scale:1}),layers.push({id:"MidFields2",image:"m1bg03",xSpeed:.13,y:-160,amount:15,scale:1.6}),layers.push({id:"MidFields3",image:"m1bg04",xSpeed:.15,y:300,amount:15,scale:1});for(var i=0;i<layers.length;i++){this._world.addLayer(layers[i].id,new PIXI.Point(layers[i].xSpeed,0));for(var areaRect=null,startX=0,j=0;j<layers[i].amount;j++){var obj=new BackgroundImage({image:layers[i].image,scale:layers[i].scale});obj.init(),null==areaRect&&(areaRect=obj.areaRect),this._world.addObjectToLayer(obj,layers[i].id,startX+j*areaRect.width,layers[i].y)}}this._roarCloud=new BackgroundImage({image:"m1ancestor_clouds",scale:1}),this._roarCloud.init(),this._roarCloud.alpha=0,this._world.addObjectToLayer(this._roarCloud,"clouds",0,0)},GameScreen.prototype.onTouchStart=function(event){this._avatar.touchStart()},GameScreen.prototype.onTouchEnd=function(event){this._gameUI.tutorialFingerActive?(this._gameUI.deactivateTutorialFinger(),this._paused&&this.resume()):this._avatar.touchEnd()},GameScreen.prototype.onCollision=function(object1,object2){if("avatar"==object1.type){if("token"==object2.type&&!object2.hasBeenCollected){var pointOnScreen=this._world.getObjectPositionOnScreen(object2);pointOnScreen.x+=-1*object2.areaRect.x,pointOnScreen.y-=-1*object2.areaRect.y,object2.collect(),this._tokens++,this._gameUI.animateToken(object2.graphic,pointOnScreen,this._tokens),Emitter.add(this._world.getLayerContainer("gameLayer"),["cfx4_t_glow a8_alpha"],"particle_coin_collect_burst",object2.x+50,object2.y-25),SoundSFX.play("sfx_tlg_ui_collectcoin"),SoundSFX.playRandomFrom(["sfx_tlg_ui_collectcoin_01","sfx_tlg_ui_collectcoin_02","sfx_tlg_ui_collectcoin_03"])}if("roarToken"!=object2.type||object2.hasBeenCollected)if("boulder1"==object2.type||"hyena"==object2.type){if("hyena"==object2.type&&!object2.collided&&!this._avatar.dashing||"boulder1"==object2.type&&!object2.collided&&this._avatar.dashing){Emitter.add(this._world.getLayerContainer("gameLayer"),["m1dust1","m1dust3"],"particle_enemy_hit_dustcloud",object2.x+50,object2.y)}object2.collided||this._avatar.dashing?!object2.collided&&this._avatar.dashing&&"boulder1"==object2.type&&(object2.collide(),Common.animator.add(TweenMax.to(object2,.5,{alpha:0})),SoundSFX.play("sfx_tlg_impact_villaingeneral_01")):("boulder1"==object2.type?(this._avatar.knockBack(),this._gameUI.activateTutorialFinger(),SoundSFX.playRandomFrom(["sfx_tlg_impact_rock_01","sfx_tlg_impact_rock_02","sfx_tlg_impact_rock_03"]),SoundSFX.playVO("low","vo_hitobstacle_sundips_010_kion")):"hyena"==object2.type&&(this._avatar.velocity.x=-5,SoundSFX.play("sfx_tlg_impact_villaingeneral_01"),this.takeDamage(),this._lives>0&&SoundSFX.playVO("low","vo_hitobstacle_010_kion")),object2.collide())}else if("hiddenCharacter"!=object2.type||object2.collected)"hole"!=object2.type||object2.dropped||(this._avatar.accelerating=!1,this._avatar.allowPathCollisions=!1,this._avatar.velocity.x=.01,this._avatar.y>=object2.y-50&&(object2.dropped=!0,this._avatar.hide(),this._avatar.dashing||this.takeDamage(),Common.animator.add(TweenMax.to(this._avatar,1,{x:object2.x+object2.width,y:object2.y-270,ease:Sine.easeInOut,onCompleteScope:this,onComplete:function(){this._avatar.show(),this._avatar.allowPathCollisions=!0,this._avatar.setAnimation("recover"),SoundSFX.playRandomFrom(["sfx_tlg_kion_edgerecover_01","sfx_tlg_kion_edgerecover_02"]),SoundSFX.playVO("low","vo_hangingon_010_kion")}}))));else{this._gameUI.collectCharacter(object2.character),object2.stop&&(this._avatar.celebrate(),Common.animator.setTimeout(function(){this._avatar.run(),0==this._level?this._avatar.enableJump=!1:this._avatar.enableJump=!0},2,this));var endChars=this._world.getAllObjectsOfType("hiddenCharacter");for(var i in endChars)endChars[i].collect(),endChars[i].collected=!0}else{var pointOnScreen=this._world.getObjectPositionOnScreen(object2);pointOnScreen.x+=-1*object2.areaRect.x,pointOnScreen.y-=-1*object2.areaRect.y,object2.collect(),Common.roarTokens++,this._gameUI.animateRoarToken(object2.graphic,pointOnScreen),Emitter.add(this._world.getLayerContainer("gameLayer"),["cfx4_t_glow a8"],"particle_coin_collect_burst",object2.x+50,object2.y-25),SoundSFX.play("sfx_tlg_ui_roarcoin_collect")}}},GameScreen.prototype.onRoarIconClicked=function(){this._avatar.dash(),Common.roarTokens=0,SoundSFX.stop("music_grasslands"),SoundSFX.play("music_grasslands_roar",{loop:!0}),this._speedLinesEmitter.emit=!0,Common.animator.add(TweenMax.to(this._roarCloud,.5,{alpha:1})),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","roarmode_used_"+(this._level+1))),Common.usedRoarMode||(Common.usedRoarMode=!0,this._hitArea.interactive=!0,this.resume())},GameScreen.prototype.onRoarEnded=function(){SoundSFX.stop("music_grasslands_roar"),SoundSFX.play("music_grasslands",{loop:!0}),this._speedLinesEmitter.emit=!1,Common.animator.add(TweenMax.to(this._roarCloud,.5,{alpha:0})),this._gameUI.roarModeEnded()},GameScreen.prototype.onRoarActivated=function(){Common.usedRoarMode||(this._hitArea.interactive=!1,this.pause(),this._gameUI.activateTutorialFinger(this._rightEdge-200,Common.STAGE_HEIGHT-140,-1,1,30))}},{"../Common":3,"../game/Avatar":4,"../game/BackgroundImage":5,"../game/Boulder1":6,"../game/GameUI":8,"../game/HiddenCharacter":9,"../game/Hole":10,"../game/Hyena":11,"../game/MapReader":12,"../game/RoarToken":13,"../game/SceneImage":14,"../game/Token":15,"../game/World":16,"../general/Emitter":17,"../general/SoundSFX":18,"./SimpleScreen":33}],28:[function(require,module,exports){function LevelCompleteScreen(levelNumber,score,unlockedCharacters){this._background=null,this._levelNumber=levelNumber,this._score=score,this._unlockedCharacters=unlockedCharacters,this._nextButton=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=LevelCompleteScreen,LevelCompleteScreen.prototype=Object.create(SimpleScreen.prototype),LevelCompleteScreen.prototype.constructor=LevelCompleteScreen,LevelCompleteScreen.prototype.init=function(){console.log("SPLASH INITIALIZED"),SimpleScreen.prototype.init.call(this),this._background=new PIXI.Sprite(this._assetManager.getTexture("end_game_success")),this._background.anchor=new PIXI.Point(.5,.5),this._background.x=Common.STAGE_WIDTH/2,this._background.y=Common.STAGE_HEIGHT/2,this.addChild(this._background);var title=new PIXI.Sprite(this._assetManager.getTexture("end_game_title"));title.anchor=new PIXI.Point(.5,0),title.scale=new PIXI.Point(.91,.91),title.x=Common.STAGE_WIDTH/2,title.y=25,this.addChild(title),levelText=new TextItem("GAME_LEVEL"),levelText.copy=levelText.readCopy("GAME_LEVEL").copy.replace("**",(this._levelNumber+1).toString()),levelText.x=Common.STAGE_WIDTH/2,levelText.y=200,this.addChild(levelText);var scoreText=new p3.BitmapText(this._score.toString(),this._assetManager.getFontAtlas("coffeehouse_48"),p3.BitmapText.ALIGN_RIGHT);if(scoreText.x=Common.STAGE_WIDTH/2-10,scoreText.y=540,this.addChild(scoreText),1==this._levelNumber){var beshte=new PIXI.Sprite(this._assetManager.getTexture("end_game_beshte"));beshte.x=Common.STAGE_WIDTH/2-800,beshte.y=320,this.addChild(beshte);var bunga=new PIXI.Sprite(this._assetManager.getTexture("end_game_bunga"));bunga.x=Common.STAGE_WIDTH/2-600,bunga.y=380,this.addChild(bunga);var fuli=new PIXI.Sprite(this._assetManager.getTexture("end_game_fuli"));fuli.x=Common.STAGE_WIDTH/2-900,fuli.y=380,this.addChild(fuli);var ono=new PIXI.Sprite(this._assetManager.getTexture("end_game_ono"));ono.x=Common.STAGE_WIDTH/2-750,ono.y=390,this.addChild(ono)}else if(null!=this._unlockedCharacters)for(var i=0;i<this._unlockedCharacters.length;i++){var unlockedCharacter=new PIXI.Sprite(this._assetManager.getTexture("end_game_"+this._unlockedCharacters[i]));unlockedCharacter.anchor=new PIXI.Point(1,1),1==i&&(unlockedCharacter.x=Common.STAGE_WIDTH/2-40,unlockedCharacter.y=770),0==i&&(unlockedCharacter.x=Common.STAGE_WIDTH/2-200,unlockedCharacter.y=720),this.addChild(unlockedCharacter)}var medal="bronze";this._score>55?medal="gold":this._score>30&&(medal="silver");var medalSpr=new PIXI.Sprite(this._assetManager.getTexture("end_game_medal_"+medal));medalSpr.x=Common.STAGE_WIDTH/2+10,medalSpr.y=Common.STAGE_HEIGHT/2+60,medalSpr.rotation=90*PIXI.DEG_TO_RAD,medalSpr.anchor=new PIXI.Point(.5,.5),medalSpr.alpha=0,medalSpr.scale=new PIXI.Point(1.5,1.5),this.addChild(medalSpr),Common.animator.add(TweenMax.to(medalSpr,.5,{delay:.5,rotation:0,alpha:1,ease:Sine.easeInOut})),Common.animator.add(TweenMax.to(medalSpr.scale,.5,{delay:.5,x:1,y:1,ease:Sine.easeInOut,onStart:function(){SoundSFX.play("sfx_tlg_ui_earnmedal")}})),this._nextButton=new p3.Button(this._assetManager.getTexture("btn_next")),this._nextButton.y=Common.STAGE_HEIGHT-100,this._nextButton.animate=!0,this._nextButton.signals.down.add(this.nextClicked,this),this.addChild(this._nextButton),this._addBorders(),this._addMuteButton(),SoundSFX.play("music_results",{loop:!0}),0==this._levelNumber?SoundSFX.playVO("high","vo_missionsuccess_020_bunga",null,1e3):SoundSFX.playVO("high","vo_level2_results_screen",null,1e3)},LevelCompleteScreen.prototype.dispose=function(){SoundSFX.stop("music_results"),SoundSFX.stop("vo_level2_results_screen"),SoundSFX.stop("vo_missionsuccess_020_bunga")},LevelCompleteScreen.prototype.update=function(){SimpleScreen.prototype.update.call(this)},LevelCompleteScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._nextButton.x=Math.min(this._background.x+this._background.width/2-250,this._rightEdge-60),this._muteButton.x=this._getFirstButtonPositionRight()},LevelCompleteScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},LevelCompleteScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},LevelCompleteScreen.prototype.nextClicked=function(){this.signals.requestedNextScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_generalselect")}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"./SimpleScreen":33}],29:[function(require,module,exports){function LevelFailScreen(levelNumber){this._background=null,this._nextButton=null,this._levelNumber=levelNumber,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=LevelFailScreen,LevelFailScreen.prototype=Object.create(SimpleScreen.prototype),LevelFailScreen.prototype.constructor=LevelFailScreen,LevelFailScreen.prototype.init=function(){console.log("SPLASH INITIALIZED"),SimpleScreen.prototype.init.call(this),this._background=new PIXI.Sprite(this._assetManager.getTexture("end_game_fail")),this._background.anchor=new PIXI.Point(.5,.5),this._background.x=Common.STAGE_WIDTH/2,this._background.y=Common.STAGE_HEIGHT/2,this.addChild(this._background);var title=new PIXI.Sprite(this._assetManager.getTexture("end_game_title"));title.anchor=new PIXI.Point(.5,0),title.scale=new PIXI.Point(.91,.91),title.x=Common.STAGE_WIDTH/2,title.y=25,this.addChild(title),levelText=new TextItem("GAME_LEVEL"),levelText.copy=levelText.readCopy("GAME_LEVEL").copy.replace("**",(this._levelNumber+1).toString()),levelText.x=Common.STAGE_WIDTH/2,levelText.y=200,this.addChild(levelText);var tryAgainText=new TextItem("GAME_TRY_AGAIN");tryAgainText.x=Common.STAGE_WIDTH/2,tryAgainText.y=300,this.addChild(tryAgainText),this._nextButton=new p3.Button(this._assetManager.getTexture("btn_next")),this._nextButton.y=Common.STAGE_HEIGHT-100,this._nextButton.animate=!0,this._nextButton.signals.down.add(this.nextClicked,this),this.addChild(this._nextButton),this._addBorders(),this._addMuteButton(),SoundSFX.playVO("high","music_grasslands_fail"),SoundSFX.playVO("high","vo_missionfail_010_ono",null,1e3)},LevelFailScreen.prototype.dispose=function(){SoundSFX.stop("music_grasslands_fail"),SoundSFX.stop("vo_missionfail_010_ono")},LevelFailScreen.prototype.update=function(){SimpleScreen.prototype.update.call(this)},LevelFailScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._nextButton.x=Math.min(this._background.x+this._background.width/2-250,this._rightEdge-60),this._muteButton.x=this._getFirstButtonPositionRight()},LevelFailScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},LevelFailScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},LevelFailScreen.prototype.nextClicked=function(){this.signals.requestedNextScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_generalselect")}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"./SimpleScreen":33}],30:[function(require,module,exports){function LevelSelectScreen(startingLevel){this._startingLevel=startingLevel,this._background=null,this._logo=null,this._itemHolder=null,this._leftButton=null,this._rightButton=null,this._items=null,this._itemPositions=null,
this._currentItem=2,this._asterisk=null,this._characters=null,this._blinkTimer=0,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=LevelSelectScreen,LevelSelectScreen.prototype=Object.create(SimpleScreen.prototype),LevelSelectScreen.prototype.constructor=LevelSelectScreen,LevelSelectScreen.prototype.init=function(){console.log("SPLASH INITIALIZED"),SimpleScreen.prototype.init.call(this),this._background=new PIXI.Sprite(this._assetManager.getTexture("lvl_select")),this._background.anchor=new PIXI.Point(.5,.5),this._background.x=Common.STAGE_WIDTH/2,this._background.y=Common.STAGE_HEIGHT/2,this.addChild(this._background),this._characters={};var kion=new PIXI.Sprite(this._assetManager.getTexture("lair_kion"));kion.anchor=new PIXI.Point(0,1),kion.x=Common.STAGE_WIDTH/2-100,kion.y=Common.STAGE_HEIGHT/2-170+kion.height,this.addChild(kion),this._characters.kion=kion,Common.animator.add(TweenMax.to(kion.scale,1.5,{delay:Math.random(),y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0}));var bunga=new PIXI.Sprite(this._assetManager.getTexture("lair_bunga_"+(Common.unlocks.bunga?"un":"")+"locked"));bunga.anchor=new PIXI.Point(0,1),bunga.x=Common.STAGE_WIDTH/2-250,bunga.y=Common.STAGE_HEIGHT/2-100+bunga.height,this.addChild(bunga),Common.unlocks.bunga&&(this._characters.bunga=bunga,Common.animator.add(TweenMax.to(bunga.scale,1.5,{delay:Math.random(),y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0})));var fuli=new PIXI.Sprite(this._assetManager.getTexture("lair_fuli_"+(Common.unlocks.fuli?"un":"")+"locked"));fuli.anchor=new PIXI.Point(0,1),fuli.x=Common.STAGE_WIDTH/2-550,fuli.y=Common.STAGE_HEIGHT/2-150+fuli.height,this.addChild(fuli),Common.unlocks.fuli&&(this._characters.fuli=fuli,Common.animator.add(TweenMax.to(fuli.scale,2,{delay:Math.random(),y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0})));var ono=new PIXI.Sprite(this._assetManager.getTexture("lair_ono_"+(Common.unlocks.ono?"un":"")+"locked"));ono.anchor=new PIXI.Point(0,1),ono.x=Common.STAGE_WIDTH/2+150,ono.y=Common.STAGE_HEIGHT/2-80+ono.height,this.addChild(ono),Common.unlocks.ono&&(this._characters.ono=ono,Common.animator.add(TweenMax.to(ono.scale,2,{delay:Math.random(),y:.98,ease:Sine.easeInOut,repeat:-1,yoyo:!0})));var beshte=new PIXI.Sprite(this._assetManager.getTexture("lair_beshte_"+(Common.unlocks.beshte?"un":"")+"locked"));beshte.anchor=new PIXI.Point(0,1),beshte.x=Common.STAGE_WIDTH/2+160,beshte.y=Common.STAGE_HEIGHT/2-230+beshte.height,this.addChild(beshte),Common.unlocks.beshte&&(this._characters.beshte=beshte,Common.animator.add(TweenMax.to(beshte.scale,2,{delay:Math.random(),y:.99,ease:Sine.easeInOut,repeat:-1,yoyo:!0}))),this._logo=new PIXI.Sprite(this._assetManager.getTexture("logo")),this._logo.anchor=new PIXI.Point(.5,.5),this._logo.x=Common.STAGE_WIDTH/2,this._logo.y=100,this.addChild(this._logo);var leftVine=new PIXI.Sprite(this._assetManager.getTexture("lair_foregroundvine_02a"));leftVine.anchor=new PIXI.Point(.5,0),leftVine.y=-30,leftVine.x=Common.STAGE_WIDTH/2-550,this.addChild(leftVine),Common.animator.add(TweenMax.to(leftVine,4,{rotation:-5*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,yoyo:!0,repeat:-1}));var midVine=new PIXI.Sprite(this._assetManager.getTexture("lair_foregroundvine_02b"));midVine.anchor=new PIXI.Point(.5,0),midVine.y=-30,midVine.x=Common.STAGE_WIDTH/2+300,this.addChild(midVine),Common.animator.add(TweenMax.to(midVine,3,{rotation:2*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,yoyo:!0,repeat:-1}));var rightVine=new PIXI.Sprite(this._assetManager.getTexture("lair_foregroundvine_02c"));rightVine.anchor=new PIXI.Point(.5,0),rightVine.y=-30,rightVine.x=Common.STAGE_WIDTH/2+500,this.addChild(rightVine),Common.animator.add(TweenMax.to(rightVine,3.5,{rotation:4*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,yoyo:!0,repeat:-1})),this._itemHolder=new PIXI.Container,this._itemHolder.x=Common.STAGE_WIDTH/2,this._itemHolder.y=Common.STAGE_HEIGHT/2,this.addChild(this._itemHolder),this._itemPositions=[{pos:new PIXI.Point(-800,240),scale:.4},{pos:new PIXI.Point(-450,200),scale:.7},{pos:new PIXI.Point(0,170),scale:1},{pos:new PIXI.Point(450,200),scale:.7},{pos:new PIXI.Point(800,240),scale:.4}],Common.LEFT_TO_RIGHT||this._itemPositions.reverse(),this._items=[];for(var i=0;2>i;i++){var level=new p3.Button(this._assetManager.getTexture("lair_panel_"+(i+1)));level.animate=!1,level.id=i,level.signals.down.add(this.itemClicked,this),this._itemHolder.addChild(level),this._items.push(level);var locked=!0;i>0?Common.unlocks["level"+(i+1)]&&(locked=!1):locked=!1,level.playButton=new p3.Button(this._assetManager.getTexture("btn_play_square")),level.playButton.animate=!0,level.playButton.y=100,level.playButton.id=i,level.playButton.signals.down.add(this.playButtonClicked,this),level.addChild(level.playButton),locked?(level.playButton.animate=!1,level.playButton.interactive=!1,level.playButton.signals.down.remove(this.playButtonClicked,this),level.alpha=.5,level.locked=!0):level.locked=!1}var app=new p3.Button(this._assetManager.getTexture("lair_panel_3"));if(app.animate=!1,app.id=2,app.signals.down.add(this.itemClicked,this),this._itemHolder.addChild(app),this._items.push(app),this._assetManager.getJSON("config_data").app_button.live){app.playButton=new p3.Button(this._assetManager.getTexture("btn_app")),app.playButton.animate=!0,app.playButton.y=100,app.playButton.id=2,app.playButton.signals.down.add(this.playButtonClicked,this),app.addChild(app.playButton),app.locked=!1;var appText=new TextItem("APP_PAID_APP_AVAILABLE");app.playButton.addChild(appText)}else app.locked=!0,app.visible=!1,null!=this._startingLevel&&(this._startingLevel=Math.min(1,this._startingLevel));this._leftButton=new p3.Button(this._assetManager.getTexture(Common.LEFT_TO_RIGHT?"btn_left":"btn_right")),this._leftButton.animate=!0,this._leftButton.y=Common.STAGE_HEIGHT/2,this._leftButton.scale=new PIXI.Point(0,0),this._leftButton.signals.down.add(this.leftClicked,this),this.addChild(this._leftButton),this._rightButton=new p3.Button(this._assetManager.getTexture(Common.LEFT_TO_RIGHT?"btn_right":"btn_left")),this._rightButton.animate=!0,this._rightButton.y=Common.STAGE_HEIGHT/2,this._rightButton.scale=new PIXI.Point(0,0),this._rightButton.signals.down.add(this.rightClicked,this),this.addChild(this._rightButton),this.positionItems(!1),null!=this._startingLevel?this._currentItem=this._startingLevel:this._currentItem=0,console.log(this._currentItem),this.positionItems(!0,0==this._currentItem?1.4:.7),this._addBorders(),this._addMuteButton();var tl=new TimelineMax;tl.to(this._itemHolder,.5,{y:Common.STAGE_HEIGHT/2,startAt:{y:Common.STAGE_HEIGHT/2+400,ease:Expo.easeOut}}),tl.to(this._leftButton.scale,.3,{x:1,y:1,ease:Back.easeOut}),tl.to(this._rightButton.scale,.3,{x:1,y:1,ease:Back.easeOut}),Common.animator.add(tl),SoundSFX.play("music_lair",{loop:!0}),this._asterisk=new TextItem("APP_PARENT_PERMISSION_ASTERISK"),this._asterisk.y=Common.STAGE_HEIGHT-20,this._assetManager.getJSON("config_data").app_button.live&&this.addChild(this._asterisk),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","carousel_screen"))},LevelSelectScreen.prototype.dispose=function(){SoundSFX.stop("music_lair")},LevelSelectScreen.prototype.update=function(){if(SimpleScreen.prototype.update.call(this),this._blinkTimer--,this._blinkTimer<=0){var charArr=[];for(var i in this._characters)charArr.push(i);var rand=charArr[Math.floor(Math.random()*charArr.length)];this._characters[rand].texture=this._assetManager.getTexture("lair_"+rand+"_blink"),Common.animator.setTimeout(function(){this._characters[rand].texture=this._assetManager.getTexture("lair_"+rand+("kion"==rand?"":"_unlocked"))},.1,this),this._blinkTimer=100+100*Math.random()}},LevelSelectScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this);var left=Math.max(this._background.x-this._background.width/2+80,this._leftEdge+60),right=Math.min(this._background.x+this._background.width/2-80,this._rightEdge-60);Common.LEFT_TO_RIGHT?(this._rightButton.x=right,this._leftButton.x=left):Common.LEFT_TO_RIGHT||(this._rightButton.x=left,this._leftButton.x=right),this._muteButton.x=this._getFirstButtonPositionRight(),this._asterisk.x=left},LevelSelectScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},LevelSelectScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},LevelSelectScreen.prototype.positionItems=function(animate,speed){var startingPosition=this._items.length-1-this._currentItem;speed=speed||.5;for(var i=0;i<this._items.length;i++){var x=this._itemPositions[startingPosition+i].pos.x,y=this._itemPositions[startingPosition+i].pos.y,scale=this._itemPositions[startingPosition+i].scale;animate?(Common.animator.add(TweenMax.to(this._items[i],speed,{x:x,y:y,ease:Sine.easeInOut})),Common.animator.add(TweenMax.to(this._items[i].scale,speed,{x:scale,y:scale,ease:Sine.easeInOut}))):(this._items[i].x=x,this._items[i].y=y,this._items[i].scale.x=this._items[i].scale.y=scale),startingPosition+i==Math.floor(this._itemPositions.length/2)?this._items[i].playButton&&(this._items[i].playButton.interactive=!0):this._items[i].playButton&&(this._items[i].playButton.interactive=!1)}0==this._currentItem?Common.animator.add(TweenMax.to(this._leftButton,.3,{alpha:0})):Common.animator.add(TweenMax.to(this._leftButton,.3,{alpha:1}));var limit=this._items.length-1;this._assetManager.getJSON("config_data").app_button.live||(limit=this._items.length-2),this._currentItem==limit?Common.animator.add(TweenMax.to(this._rightButton,.3,{alpha:0})):Common.animator.add(TweenMax.to(this._rightButton,.3,{alpha:1})),SoundSFX.play("sfx_tlg_kion_jump_01",null,200)},LevelSelectScreen.prototype._selectButton=function(id){2>id?(this.signals.requestedNextScreen.dispatch(id),SoundSFX.play("sfx_tlg_ui_mapselect"),0==id&&(SoundSFX.isSoundPlaying("vo_kion-1")||(SoundSFX.play("vo_kion-1"),console.log("play sound")))):(this.appButtonClicked(),SoundSFX.play("sfx_ui_app_press2"))},LevelSelectScreen.prototype.leftClicked=function(){this._currentItem>0&&(this._currentItem--,this.positionItems(!0),SoundSFX.play("sfx_tlg_ui_generalselect"))},LevelSelectScreen.prototype.rightClicked=function(){var limit=this._items.length-1;this._assetManager.getJSON("config_data").app_button.live||(limit=this._items.length-2),this._currentItem<limit&&(this._currentItem++,this.positionItems(!0),SoundSFX.play("sfx_tlg_ui_generalselect"))},LevelSelectScreen.prototype.appButtonClicked=function(){Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_carousel_item")),this.signals.requestedAppOverlay.dispatch()},LevelSelectScreen.prototype.itemClicked=function(item){this._currentItem!=item.id?(this._currentItem=item.id,this.positionItems(!0)):item.locked||this._selectButton(item.id)},LevelSelectScreen.prototype.playButtonClicked=function(button){this._selectButton(button.id)}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"./SimpleScreen":33}],31:[function(require,module,exports){function OutroScreen(){this._screensHolder=null,this._screens=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),SoundSFX=require("../general/SoundSFX");module.exports=OutroScreen,OutroScreen.prototype=Object.create(SimpleScreen.prototype),OutroScreen.prototype.constructor=OutroScreen,OutroScreen.prototype.init=function(){console.log("SPLASH INITIALIZED"),SimpleScreen.prototype.init.call(this),this._overlay=new PIXI.Sprite(Common.generatedTextures.blackSquare),this._overlay.width=Common.STAGE_WIDTH,this._overlay.height=Common.STAGE_HEIGHT,this.addChild(this._overlay),this._screensHolder=new PIXI.Container,this.addChild(this._screensHolder),this._addBorders(),this.showFallBack(),this._nextButton=new p3.Button(this._assetManager.getTexture("btn_next")),this._nextButton.y=Common.STAGE_HEIGHT-100,this._nextButton.signals.down.add(this.nextClicked,this),this.addChild(this._nextButton)},OutroScreen.prototype.dispose=function(){SoundSFX.stopAllVO()},OutroScreen.prototype.showFallBack=function(){SoundSFX.playVO("high","vo_m1_intro"),this._screens=[];var screenData=[{name:"video_fallback_01",time:3},{name:"video_fallback_02",time:4},{name:"video_fallback_03",time:8},{name:"video_fallback_04",time:4},{name:"video_fallback_05",time:6}],tl=new TimelineMax;Common.animator.add(tl);for(var i=0;i<screenData.length;i++){var screen=new PIXI.Sprite(this._assetManager.getTexture(screenData[i].name));screen.anchor=new PIXI.Point(.5,.5),screen.scale=new PIXI.Point(1.3,1.3),screen.x=2*Common.STAGE_WIDTH,screen.y=Common.STAGE_HEIGHT/2,tl.to(screen,.5,{x:Common.STAGE_WIDTH/2,ease:Sine.easeOut,onStartScope:this,onStartParams:[screen,screenData[i].time],onStart:function(screen,time){TweenMax.to(screen.scale,10,{x:1.5,y:1.5}),TweenMax.to(screen,.3,{x:-Common.STAGE_WIDTH/2,delay:time+.6,ease:Sine.easeIn})}}),tl.to(screen,screenData[i].time,{onComplete:function(){}}),this._screens.push(screen)}for(var i=this._screens.length-1;i>=0;i--)this._screensHolder.addChild(this._screens[i]);tl.to(this._screensHolder,1,{onCompleteScope:this,onComplete:function(){this.signals.requestedNextScreen.dispatch()}})},OutroScreen.prototype.update=function(){SimpleScreen.prototype.update.call(this)},OutroScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._nextButton.x=Math.min(Common.STAGE_WIDTH/2+683-250,this._rightEdge-60)},OutroScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},OutroScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},OutroScreen.prototype.nextClicked=function(){this.signals.requestedNextScreen.dispatch(),SoundSFX.play("sfx_tlg_ui_generalselect")}},{"../Common":3,"../general/SoundSFX":18,"./SimpleScreen":33}],32:[function(require,module,exports){function Preloader(){this.loadedPercentage=0,this._background=null,this._overlay=null,this._sun=null,this._music=null,this._hiddenText=null,this.fontLoaded=!1,this._totalFontWaitTime=0,SimpleScreen.call(this),this.signals.fontLoaded=new signals.Signal}var SimpleScreen=require("./SimpleScreen"),Common=require("../Common"),SoundSFX=require("../general/SoundSFX"),TextItem=require("../general/TextItem");module.exports=Preloader,Preloader.prototype=Object.create(SimpleScreen.prototype),Preloader.prototype.constructor=Preloader,Preloader.prototype.init=function(){console.log("PRELOADER INITIALIZED"),SimpleScreen.prototype.init.call(this),this.loadedPercentage=0,this._background=new PIXI.Sprite(this._assetManager.getTexture("preloader_bg")),this._background.anchor.x=.5,this._background.x=Common.STAGE_WIDTH/2,this.addChild(this._background),this._overlay=new PIXI.Sprite(this._assetManager.getTexture("preloader_overlay")),this._overlay.x=Common.STAGE_WIDTH/2,this._overlay.anchor.x=.5,this.addChild(this._overlay),this._sun=new PIXI.Sprite(this._assetManager.getTexture("preloader_sun")),this._sun.anchor=new PIXI.Point(.5,.5),this._sun.x=Common.STAGE_WIDTH/2,this._sun.y=Common.STAGE_HEIGHT/2+100,this.addChild(this._sun);var ground=new PIXI.Sprite(this._assetManager.getTexture("preloader_ground"));ground.anchor.x=.5,ground.x=Common.STAGE_WIDTH/2,ground.y=290,this.addChild(ground);var logo=new PIXI.Sprite(this._assetManager.getTexture("logo_preloader"));logo.anchor=new PIXI.Point(.5,.5),logo.y=300,ground.addChild(logo),this._addBorders(),p3.Device.isMobile||(this._music=SoundSFX.play("music_loading-shorter-edited")),this._hiddenText=new TextItem("LOADING"),this.checkFontLoaded()},Preloader.prototype.dispose=function(){SimpleScreen.prototype.dispose.call(this),this._music&&this._music.fadeOut(0,100)},Preloader.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this.x=.5*(p3.View.width-Common.STAGE_WIDTH),this.y=.5*(p3.View.height-Common.STAGE_HEIGHT)},Preloader.prototype.update=function(){console.log("LOADING: "+this.loadedPercentage);var inverse=1-this.loadedPercentage/100;this._overlay.alpha=inverse,this._sun.y=Common.STAGE_HEIGHT/2-70+200*inverse},Preloader.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(callback,scope)},Preloader.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(callback,scope)},Preloader.prototype.checkFontLoaded=function(){Common.animator.setTimeout(function(){var text=new TextItem("LOADING");text.width!=this._hiddenText.width||text.height!=this._hiddenText.height?(this.signals.fontLoaded.dispatch(),this.fontLoaded=!0):(this._totalFontWaitTime+=.5,this._totalFontWaitTime>=4?(this.signals.fontLoaded.dispatch(),this.fontLoaded=!0):this.checkFontLoaded())},.5,this)}},{"../Common":3,"../general/SoundSFX":18,"../general/TextItem":19,"./SimpleScreen":33}],33:[function(require,module,exports){function SimpleScreen(){this.signals={},this.signals.requestedNextScreen=new signals.Signal,this.signals.requestedPreviousScreen=new signals.Signal,this.signals.requestedAppOverlay=new signals.Signal,this.signals.requestedPauseOverlay=new signals.Signal,this.signals.requestedHelpOverlay=new signals.Signal,this._assetManager=p3.AssetManager.instance,this._tweens=null,this._centre=null,this._leftEdge=0,this._rightEdge=0,this._guiButtonTopMargin=100,this._pauseButton=null,this._muteButton=null,p3.Screen.call(this)}var Common=require("../Common"),Scene=require("../lib/Scene"),SoundSFX=require("../general/SoundSFX");module.exports=SimpleScreen,SimpleScreen.prototype=Object.create(Scene.prototype),SimpleScreen.prototype.constructor=SimpleScreen,SimpleScreen.prototype.init=function(){this._tweens=[],this._centre=new PIXI.Point(Common.STAGE_WIDTH/2,Common.STAGE_HEIGHT/2)},SimpleScreen.prototype.dispose=function(){this.signals.requestedNextScreen.dispose(),this.signals.requestedPreviousScreen.dispose();for(var tween,i=0;i<this._tweens.length;++i)tween=this._tweens[i],tween&&tween.kill();this._tweens.length=0},SimpleScreen.prototype.resize=function(){this.x=.5*(p3.View.width-Common.STAGE_WIDTH),this._rightEdge=this._centre.x+p3.View.width/2,this._leftEdge=this._centre.x-p3.View.width/2},SimpleScreen.prototype.activate=function(){this.animateIn(function(){},this)},SimpleScreen.prototype.animateIn=function(callback,scope){scope=scope||window},SimpleScreen.prototype.animateOut=function(callback,scope){scope=scope||window},SimpleScreen.prototype.hideGUI=function(){},SimpleScreen.prototype.showGUI=function(){},SimpleScreen.prototype._addBorders=function(){var borderLeft=new PIXI.Sprite(this._assetManager.getTexture("boarder_l"));borderLeft.x=0,this.addChild(borderLeft);var borderRight=new PIXI.Sprite(this._assetManager.getTexture("boarder_l"));borderRight.x=Common.STAGE_WIDTH,borderRight.scale.x=-1,this.addChild(borderRight)},SimpleScreen.prototype._addPauseButton=function(){this._pauseButton=new p3.Button(this._assetManager.getTexture("btn_pause")),this._pauseButton.y=this._guiButtonTopMargin,this._pauseButton.animate=!0,this._pauseButton.signals.down.add(this.onPause,this),this.addChild(this._pauseButton)},SimpleScreen.prototype._addMuteButton=function(){this._muteButton=new p3.MuteButton(this._assetManager.getTexture("btn_sound"),this._assetManager.getTexture("btn_mute")),this._muteButton.id="mute",this._muteButton.y=this._guiButtonTopMargin,this._muteButton.animate=!0,this._muteButton.init(),this._muteButton.signals.down.add(this.onMute,this),this.addChild(this._muteButton)},SimpleScreen.prototype._calculateButtonPosition=function(side,position){var x;"right"==side&&1==position?x=this._getFirstButtonPositionRight():"left"==side&&1==position?x=this._getFirstButtonPositionLeft():"right"==side&&2==position?x=this._getSecondButtonPositionRight():"left"==side&&2==position&&(x=this._getSecondButtonPositionLeft())},SimpleScreen.prototype._getFirstButtonPositionRight=function(){return.5*(Common.STAGE_WIDTH+p3.View.width)-100},SimpleScreen.prototype._getSecondButtonPositionRight=function(){return.5*(Common.STAGE_WIDTH+p3.View.width)-200},SimpleScreen.prototype._getFirstButtonPositionLeft=function(){return.5*(Common.STAGE_WIDTH-p3.View.width)+100},SimpleScreen.prototype._getSecondButtonPositionLeft=function(){return.5*(Common.STAGE_WIDTH-p3.View.width)+200},SimpleScreen.prototype.onButtonClickedPrevious=function(button){},SimpleScreen.prototype.onPause=function(){this.signals.requestedPauseOverlay.dispatch(),SoundSFX.play("sfx_tlg_ui_pause")},SimpleScreen.prototype.onMute=function(){SoundSFX.play("sfx_tlg_ui_back")}},{"../Common":3,"../general/SoundSFX":18,"../lib/Scene":21}],34:[function(require,module,exports){function SplashScreen(){this._background=null,this._title=null,this._playButton=null,this._appButton=null,this._asterisk=null,this._watch=null,SimpleScreen.call(this)}var Common=require("../Common"),SimpleScreen=require("./SimpleScreen"),SoundSFX=(require("../game/Avatar"),require("../game/World"),require("../general/SoundSFX")),TextItem=require("../general/TextItem");module.exports=SplashScreen,SplashScreen.prototype=Object.create(SimpleScreen.prototype),SplashScreen.prototype.constructor=SplashScreen,SplashScreen.prototype.init=function(){console.log("SPLASH INITIALIZED"),SimpleScreen.prototype.init.call(this),this._background=new PIXI.Sprite(this._assetManager.getTexture("splash")),this._background.anchor=new PIXI.Point(.5,.5),this._background.x=Common.STAGE_WIDTH/2,this._background.y=Common.STAGE_HEIGHT/2,this.addChild(this._background),this._title=new PIXI.Sprite(this._assetManager.getTexture("logo")),this._title.anchor=new PIXI.Point(.5,.5),this._title.x=Common.STAGE_WIDTH/2,this._title.y=140,this.addChild(this._title),this._addBorders(),this._playButton=new p3.Button(this._assetManager.getTexture("btn_play")),this._playButton.x=Common.STAGE_WIDTH/2,this._playButton.y=Common.STAGE_HEIGHT-130,this._playButton.animate=!0,this._playButton.signals.down.add(this.playClicked,this),this.addChild(this._playButton),this._appButton=new p3.Button(this._assetManager.getTexture("btn_app")),this._appButton.x=this._background.x-this._background.width/2+this._appButton.width/2+80,this._appButton.y=Common.STAGE_HEIGHT-120,this._appButton.animate=!0,this._appButton.signals.down.add(this.appButtonClicked,this);var appText=new TextItem("APP_PAID_APP_AVAILABLE");this._appButton.addChild(appText),this._asterisk=new TextItem("APP_PARENT_PERMISSION_ASTERISK"),this._asterisk.y=Common.STAGE_HEIGHT-20,this._watch=new TextItem("APP_WATCH_THE_LION_GUARD"),this._watch.y=Common.STAGE_HEIGHT-20,this.addChild(this._watch),this._assetManager.getJSON("config_data").app_button.live&&(this.addChild(this._appButton),this.addChild(this._asterisk)),this._addMuteButton(),p3.Device.isMobile||(SoundSFX.play("music_title_stg"),SoundSFX.play("vo_splashscreen_010_kion")),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","home_screen"))},SplashScreen.prototype.update=function(){SimpleScreen.prototype.update.call(this)},SplashScreen.prototype.resize=function(){SimpleScreen.prototype.resize.call(this),this._appButton.x=Math.max(this._background.x-this._background.width/2+this._appButton.width/2+80,this._leftEdge+this._appButton.width/2+80),this._muteButton.x=this._getFirstButtonPositionRight(),this._asterisk.x=this._appButton.x-this._appButton.width/2,this._watch.x=Math.min(this._background.x+this._background.width/2-(80+this._watch.width/2),this._rightEdge-(60+this._watch.width/2))},SplashScreen.prototype.animateIn=function(callback,scope){SimpleScreen.prototype.animateIn.call(this)},SplashScreen.prototype.animateOut=function(callback,scope){SimpleScreen.prototype.animateOut.call(this)},SplashScreen.prototype.appButtonClicked=function(){this.signals.requestedAppOverlay.dispatch(),SoundSFX.play("sfx_ui_app_press2"),Common.tracking.track(new p3.TrackingDataPlaydomGameAction("","app_available_home_screen"))},SplashScreen.prototype.playClicked=function(){this.signals.requestedNextScreen.dispatch(),p3.Device.isMobile&&SoundSFX.play("music_title_stg"),SoundSFX.play("sfx_tlg_ui_play")}},{"../Common":3,"../game/Avatar":4,"../game/World":16,"../general/SoundSFX":18,"../general/TextItem":19,"./SimpleScreen":33}],35:[function(require,module,exports){p3.TrackingModulePlaydom.prototype.track=function(data){var url="https://api.disney.com/datatech/serverlog/v1/json",params={};params.app=this._app,params.user_id=this._browserId,params.app_locale=this._appLocale,params.transaction_id=this._transactionId,params.browser_id=this._browserId,params.network=this._network,params.view_network=this._viewNetwork,params.tag=data.tag,params.context=data.context,params.action=data.action,console.log("Tracking: "+data.tag+", "+data.context+", "+data.action);var request=new XMLHttpRequest;request.open("POST",url,!0),request.setRequestHeader("Content-Type","application/json"),request.setRequestHeader("Authorization",this._authorizationId),request.send(JSON.stringify(params))}},{}]},{},[1])(1)});
