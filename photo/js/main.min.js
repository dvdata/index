function mainInit(){for(site_w=Number(window.innerWidth),site_h=Number(window.innerHeight),"win"==os_type?(set_grid_bg_img="layout_grid_complete.png",set_grid_img_path="grid_bg"):(set_grid_bg_img="layout_grid_complete_alt.png",set_grid_img_path="grid_bg_alt"),checkBrowser("ie")&&($("<link />",{href:"css/ie_formatting.css",rel:"stylesheet",type:"text/css"}).appendTo("head"),log("IE CSS set")),log("set_grid_bg_img = "+set_grid_bg_img),k=0;k<x.length;k++){var e=$("#intro_block_"+Number(k+1)),o=String(x[k].getAttribute("groupID")),i=String(x[k].getElementsByTagName("thumbnail")[0].childNodes[0].nodeValue),t=String("")+String(i).split("./")[1],s="images/"+set_grid_img_path+"/grid_bg_img_"+Number(k+1)+".jpg";intro_block_img_array[k]=i,assets_to_preload.push(t),assets_to_preload.push(s),e.data("groupID",o)}for(g=1;g<=total_groups;g++){var a=new Array;for(mm=0;mm<x.length;mm++){var r=String(x[mm].getAttribute("id")),o=String(x[mm].getAttribute("groupID"));o==String(g)&&a.push(r)}grid_groups["groupID_"+g]=a}setupKeyListener()}function addPhotosToGrid(){for(plane_motion_on=!0,i=0;i<intro_block_array.length;i++){var e=intro_block_array[i],o=$(e).data("id"),t=($(e),"./images/"+set_grid_img_path+"/grid_bg_img_"+o+".jpg");$(e).css("background-image","url("+t+")"),$(e).append('<img src="'+intro_block_img_array[i]+'" draggable="false" id="grid_photo" alt="image block">');var s=$(e).children("img");$("#grid_photos_child_container").css("background-image","url('./images/spacer.gif')"),!s.data("isMouseOver")}introAnimation()}function displayGridTitle(e){var o=$("#grid_titles");$("#grid_titles").css("background-image","url('http://wretchedbeauty.com.s3.amazonaws.com/images/group_title_label_"+e+".png')"),$("#grid_titles").css("display","block"),$("#grid_titles").css("visibility","visible"),TweenLite.to(o,0,{scale:0,alpha:0,ease:Back.easeOut,delay:0}),TweenLite.to(o,.75,{scale:1,alpha:1,ease:Back.easeOut,delay:0}),playSoundEffect("select_grid_section","true")}function hideGridTitle(){var e=$("#grid_titles");TweenLite.to(e,.75,{alpha:0,ease:Back.easeOut,delay:2})}function selectGroupID(e){selected_groupID!=e?(hilightGroupID(e),displayGridTitle(e),selected_groupID=e):activateGroupID(e)}function hilightGroupID(e){var o=grid_groups["groupID_"+e],i=String("img#grid_photo_constant_"+e);for($(i).css("opacity","1.0"),intro_shown&&($("#grid_photos_child_container").css("opacity","0.0"),$("#grid_photos_child_container").css("background-image","url('./images/grid_bg/grid_shadows_"+e+".png')"),$(".intro_block").each(function(){TweenLite.to($(this),.6,{css:{opacity:"0"},delay:0})})),gitem=0;gitem<o.length;gitem++){var t=$("#intro_block_"+o[gitem]);t.css("opacity","0.0"),intro_shown?activateSection(t,e):(TweenLite.to(t,.6,{css:{opacity:"1"},delay:0,ease:Linear.easeOut,overwrite:!0}),TweenLite.to(t,.6,{css:{opacity:"0"},delay:.7,ease:Linear.easeIn}))}activateGrayScale()}function activateSection(e,o){animating_groupID!=o&&(TweenLite.to($("#grid_photos_child_container"),.6,{css:{opacity:"1"},overwrite:!0,delay:0}),TweenLite.to(e,0,{css:{opacity:"1"},overwrite:!0,delay:0}))}function showGroupShadow(){$("#grid_photos_child_container").css("background-image","url('./images/grid_bg/grid_shadows_"+selected_groupID+".png')")}function activateGroupID(e){var o=(document.getElementById("child_container"),$("#child_container"));selected_groupID=e,plane_mouse_effect_on=!1,TweenMax.to(o,1.5,{rotationX:"0deg",rotationY:"0deg",transformOrigin:"50% 50% 0",ease:"Back.easeOut",delay:1.5}),plane_motion_on=plane_motion_on_locked_state=!1,grid_active=!1,setTimeout("playSectionVideo()",Number(3e3)),playSoundEffect("click_grid_section","false"),hideGridTitle(),$("#grid_mask_ellipse").attr("cx","0.5"),$("#grid_mask_ellipse").attr("cy","0.5"),$("#grid_photos_bg").css("-webkit-mask-position","300px 100px"),$("#grid_photos_bg").css("display","none"),$("#grid_photos_bg").css("visibility","hidden"),log("activate sectionID : "+e)}function playSectionVideo(){if(!section_video_called){var e=($("#child_container"),1),o=document.getElementById("section_video"),i=(o.getElementsByTagName("source"),".mp4");checkBrowser("mozilla")&&(i=".ogv"),$("#section_video").html('<source src="videos/group_video_'+selected_groupID+i+'" type="video/mp4" />'),$(".intro_block").each(function(){$("#intro_block_"+e);$(this).css("opacity","1"),e++}),$("img#grid_photo").css("opacity","0"),setTimeout(function(){$("#grid_photos_bg").css("opacity","0"),$("#child_container").css("background-position","3000px 3000px"),$("#grid_photos_child_container").css("background-image","url('./images/spacer.gif')")},500),$("#grid_titles").css("visibility","hidden"),$("#video_holder_bg").css("display","block"),$("#video_holder_bg").css("visibility","visible"),$("#video_holder_bg").css("opacity","1"),deactivateGrayScale(!0),fadeMusicTo(10,500),o.loop=!1,o.preload=!0,o.load(),o.play(),startVideoDistort(.7,1.25,.5),section_video_called=!0,log("play video sectionID : "+selected_groupID)}}function restartIntoVideo(){var e=document.getElementById("section_video"),o=(e.getElementsByTagName("source"),".mp4");checkBrowser("mozilla")&&(o=".ogv"),$("#section_video").html('<source src="videos/video_loop.mp4" type="video/mp4" />'),e.loop=!0,e.preload=!0,e.load(),e.play(),log("replay intro video")}function activateGrayScale(){gray_scale_active||(log("call grayscale"),$(".intro_block").each(function(){grayscale($(this))}),log("grayscale complete"),gray_scale_active=!0)}function deactivateGrayScale(e){var o=grid_groups["groupID_"+selected_groupID];for(g=0;g<total_groups;g++){var i=String("img#grid_photo_constant_"+Number(g+1));$(i).css("opacity","0")}if(gray_scale_active){for(log("call un-grayscale"),$(".intro_block").each(function(){var e=$(this).data("id");for(gitem=0;gitem<o.length;gitem++){var i=$("#intro_block_"+e),t=i.children("img");String(e)!=String(o[gitem])?grayscale.reset(i):(log("ignore gray scale "+e+" | "+o+" | "+gitem),t.attr("id",String("grid_photo_constant_"+selected_groupID)),$("img#grid_photo_constant_"+selected_groupID).css("opacity","1.0"))}}),gitem=0;gitem<o.length;gitem++){var t=$("#intro_block_"+String(o[gitem]));grayscale(t)}gray_scale_active=!1}if(e){var o=grid_groups["groupID_"+selected_groupID];for(gitem=0;gitem<o.length;gitem++)activateSection(o[gitem],selected_groupID)}}function introAnimation(){var e=100,o=intro_block_array.length;for(intro_shown&&(e=60),g=0;g<o;g++)setTimeout("animateGridBlockID("+Number(o-g)+")",Number(e*g));setTimeout("showVideoBG()",e+Number(e*o)),intro_shown?switchMusicFile(main_bgm_track):(switchMusicFile(main_bgm_track),playSoundEffect("build_grid","false"),showRightclickNotification(.75,3.75,7.25),$("#section_video").html('<source src="videos/video_loop.mp4" type="video/mp4" />')),updateBrowserTitle("",!1)}function animateGridBlockID(e){var o,i,t=$("#intro_block_"+e),s=intro_block_img_obj[String("data_"+e)];"true"!=s&&(intro_block_img_obj[String("data_"+e)]=!0,intro_block_img_obj[String("xpos_"+e)]=String($("#intro_block_"+e).css("left")),intro_block_img_obj[String("ypos_"+e)]=String($("#intro_block_"+e).css("top")),intro_block_img_obj[String("w_"+e)]=String($("#intro_block_"+e).css("width")),intro_block_img_obj[String("h_"+e)]=String($("#intro_block_"+e).css("height"))),t.css("visibility","visible"),t.css("opacity","1"),o=intro_block_img_obj[String("xpos_"+e)],i=intro_block_img_obj[String("ypos_"+e)],TweenMax.to(t,0,{css:{left:o,top:i},scale:1}),intro_shown?TweenMax.from(t,.55,{ease:Power4.easeOut,css:{top:1200},scale:1}):TweenMax.from(t,.55,{ease:"Back.easeOut",css:{left:500,top:350},scale:0})}function dropGridBlockID(e,o){var i=$("#intro_block_"+e),t=o,s=Number(.001*o);i.css("visibility","visible"),TweenMax.to(i,s,{ease:"Back.easeIn",css:{marginTop:1200},scale:0}),setTimeout("hideGridBlockID("+e+")",Number(t))}function hideGridBlockID(e){var o=$("#intro_block_"+e);o.css("visibility","hidden")}function showVideoBG(){var e=$("#video_holder_bg");e.css("scaleX","1.0"),e.css("scaleY","1.0"),e.css("display","block"),e.css("visibility","visible"),e.css("top","117px"),$("#child_container").css("background-position","3000px 3000px"),$("#child_container").css("background-image","url('http://wretchedbeauty.com.s3.amazonaws.com/images/"+set_grid_bg_img+"')"),0==intro_shown?(TweenLite.from(e,1,{scaleX:0,scaleY:0,ease:Back.easeOut,delay:0,transformOrigin:"center center"}),setTimeout(callHilightSections,Number(1200))):TweenLite.from(e,.55,{ease:Power4.easeOut,css:{top:1200},onComplete:rebuildIntroAnimationCompete}),rebuild_grid_called=!1}function dropVideoBG(){_video_holder_bg=$("#video_holder_bg"),_video_holder_bg.css("visibility","visible"),TweenLite.to(_video_holder_bg,.5,{ease:"Back.easeIn",css:{top:1200},overwrite:!0,onComplete:dropVideoBGComplete})}function dropVideoBGComplete(){hideVideoBG(),displayActiveGallery(selected_groupID,!0)}function hideVideoBG(){$("#video_holder_bg").css("visibility","hidden")}function callHilightSections(){var e=600,o=700;$("#child_container").css("opacity","1"),$("#child_container").css("background-position",""),setTimeout(function(){$("img#grid_photo").css("opacity","1"),$("#grid_photos_bg").css("opacity","1"),$("#grid_photos_bg").css("display","block"),$("#grid_photos_bg").css("visibility","visible"),$(".intro_block").each(function(){$(this).css("opacity","0")})},250),showRightFooterLinks(.75,Number(.75+.001*e*total_groups)),showShareTabIntro(.75,Number(.75+.001*e*total_groups)),setTimeout("videoHolderIntro()",Number(o)),setTimeout("hilightSections()",0),setTimeout("introAnimationCompete()",Number(o+e*total_groups))}function hilightSections(){var e=600;for(g=0;g<total_groups;g++){var o=Number(g+1),i=String("img#grid_photo_constant_"+o);$(i).css("opacity","1.0"),setTimeout("hilightGroupID("+o+")",Number(e*g))}}function videoHolderIntro(){var e=$("#video_holder");$("#video_holder_bg").css("visibility","hidden"),$("#video_holder_bg").css("display","none"),$("#video_holder_bg").css("opacity","0.0"),$("#video_holder").css("display","block"),$("#video_holder").css("visibility","visible"),TweenLite.from(e,1.5,{scaleX:0,scaleY:0,delay:.1,transformOrigin:"center center"})}function rebuildIntroAnimationCompete(){var e=$("#video_holder");$("#child_container").css("opacity","1"),$("#child_container").css("background-position",""),$("img#grid_photo").css("opacity","1"),$("#grid_photos_bg").css("-webkit-mask-position","300px 100px"),$("#grid_photos_bg").css("opacity","1"),$("#grid_photos_bg").css("display","block"),$("#grid_photos_bg").css("visibility","visible"),setTimeout(function(){$(".intro_block").each(function(){$(this).css("opacity","0")})},500),$("#video_holder_bg").css("visibility","hidden"),$("#video_holder_bg").css("display","none"),$("#video_holder_bg").css("opacity","0.0"),$("#video_holder").css("display","block"),$("#video_holder").css("visibility","visible"),TweenLite.to(e,0,{scaleX:1,scaleY:1,delay:0,transformOrigin:"center center"}),TweenLite.from(e,.75,{scaleX:0,scaleY:0,delay:.1,transformOrigin:"center center"}),introAnimationCompete()}function introAnimationCompete(){enableGridAnimation(),enableGridMouseEvents(),setCurrentSection("main_menu",!0),played_songs[current_section]="true",toggleFusionMenuType(),0==intro_shown&&(createAboutView(),enableFocusEvents()),intro_shown=!0}function enableGridAnimation(){$(".intro_block").each(function(){$(this).css("opacity","0")}),section_video_called=!1,plane_mouse_effect_on=!0,plane_motion_on=plane_motion_on_locked_state=!0,grid_active=!0}function freezeGrid(){var e=$("#child_container");gallery_grid_active&&(checkBrowser("ie")||checkBrowser("mozilla")||checkBrowser("safari")?TweenMax.to($("#gallery_thumbnail_container"),.4,{rotationX:"0deg",ease:Cubic.easeOut,transformOrigin:"50% 0% 0",overwrite:!0,delay:0}):TweenMax.to($("#gallery_thumbnail_container"),2,{rotationX:"0deg",ease:Back.easeInOut,transformOrigin:"50% 0% 0",overwrite:!0,delay:0})),checkBrowser("safari")&&plane_motion_on&&TweenMax.to(e,.75,{rotationX:"0deg",rotationY:"0deg",transformOrigin:"50% 50% 0",ease:"Cubic.easeOut",delay:0}),plane_motion_on=gallery_grid_active=!1,disableGridMouseEvents()}function unFreezeGrid(){"photo_open"!=current_section&&(plane_motion_on=plane_motion_on_locked_state,gallery_grid_active=!0,enableGridMouseEvents())}function disableGridMouseEvents(){$("#child_container").css("pointer-events","none"),$("#gallery_thumbnail_container").css("pointer-events","none")}function enableGridMouseEvents(){1==grid_active&&$("#child_container").css("pointer-events","auto"),gallery_grid_active&&$("#gallery_thumbnail_container").css("pointer-events","auto")}function buildGrid(){for("win"==os_type?assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/layout_grid_complete.png"):assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/layout_grid_complete_alt.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/layout_grid__overlay_complete.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_menu_base.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_menu_animation_sprites.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_menu_animation_sprites_shuffle.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/about_page_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/category_menu_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/main_menu_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/photo_gallery_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/photo_open_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/share_this_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/site_default_icons.png"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/fusion_menu_loader.gif"),assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/fusion_icons/fusion_menu_loader_icons.gif"),assets_to_preload.push("images/video_glitch_ani.jpg"),assets_to_preload.push("images/gallery_bg_dimmer.png"),assets_to_preload.push("images/gallery_bg_footer.png"),assets_to_preload.push("images/gallery_thumbnail_block.jpg"),assets_to_preload.push("images/static_patern.gif"),assets_to_preload.push("images/static_img_lrg.jpg"),assets_to_preload.push("images/site_entrance/entrance_bg_overlay_60.png"),assets_to_preload.push("images/site_entrance/entrance_cta_glitch_constant.gif"),assets_to_preload.push("images/site_entrance/entrance_cta_glitch_exit.gif"),assets_to_preload.push("images/site_entrance/entrance_title_logo_glitch.gif"),g=1;g<=total_groups;g++)assets_to_preload.push("http://wretchedbeauty.com.s3.amazonaws.com/images/group_title_label_"+g+".png");assets_preloader.loadFilesArray(assets_to_preload),assets_preloader.on("finish",function(){log("All assets loaded."),hidePreloader()}),assets_preloader.on("error",function(e){log("Load Error."),log(e)})}function hideVideoHolder(){$("#video_holder").css("display","none"),$("#video_holder").css("visibility","hidden"),setTimeout("destroyGrid()",Number(1e3))}function destroyGrid(){var e=100,o=400,i=intro_block_array.length;for(g=i;g>=0;g--){var t=Number(e*(i-g));setTimeout("dropGridBlockID("+Number(i-g)+","+o+")",Number(t))}setTimeout("dropVideoBG()",e+Number(e*i)),setCurrentSection("destroy_grid",!1),toggleFusionMenuType(),log("call destroy grid")}function rebuildGrid(){if(!rebuild_grid_called){var e=intro_block_array.length;for($("#gallery_container").css("display","none"),$("#gallery_container").css("visibility","hidden"),$("#child_container").css("opacity","1"),i=0;e>i;i++){var o=intro_block_array[i],t=$(o).data("id");intro_block_img_obj[String("xpos_"+t)],intro_block_img_obj[String("ypos_"+t)];$(o).css("-webkit-transform","scale(1)"),$(o).css("transform","scale(1)"),$(o).css("left",intro_block_img_obj[String("xpos_"+t)]),$(o).css("top",intro_block_img_obj[String("ypos_"+t)]),$(o).css("width",intro_block_img_obj[String("w_"+t)]),$(o).css("height",intro_block_img_obj[String("h_"+t)]),$(o).css("margin-top","0px")}for($(".intro_block").each(function(){var e=$(this).data("id"),o=$("#intro_block_"+e);o.children("img");grayscale.reset(o)}),g=0;g<total_groups;g++){var s=String("img#grid_photo_constant_"+Number(g+1));$(s).css("opacity","0")}selected_groupID=0,plane_motion_on=!0,restartIntoVideo(),introAnimation(),setCurrentSection("main_menu_loading",!1),toggleFusionMenuType(),rebuild_grid_called=!0,log("call rebuild grid")}}function showMainPreloader(){$("#site_entrance").css("visibility","visible"),$("#site_entrance").css("display","block"),$("#site_entrance").css("opacity","1.0"),TweenLite.from($("#site_entrance"),.35,{css:{opacity:"0"},ease:Linear.easeOut,delay:.6}),bypass_social_footer_sound=!0,setTimeout(showPreloadFooter,2650)}function showPreloadFooter(){0==entrance_page_init&&0==hide_preloader_called&&(bypass_social_footer_sound=!0,showFooterBar())}function hidePreloader(){hide_preloader_called=!0,startIntroMusic(),setTimeout("removePreloader()",Number(1e3))}function removePreloader(){$("#clock_loader").css("visibility","hidden"),$("#clock_loader").css("display","none"),$("#grid_photos_bg").css("opacity","0"),removeElementByID("clock_loader"),callSiteEntrance()}function hideVideo(){var e=(document.getElementById("video_holder"),$("#video_holder"));TweenLite.to(e,3.5,{scaleX:0,scaleY:0,delay:0,transformOrigin:"center center",onComplete:hideVideoHolder}),log("call hide video"),fadeMusicTo(0,1500),playSoundEffect("destroy_grid","true")}function onSiteLogoPress(){switch(current_section){case"photo_gallery":closeGallery();break;case"photo_open":closeLargeImage();break;case"category_menu":callCloseCategoryMenu();break;case"share_this":closeShareThis();break;case"about_page":callCloseAboutPage()}}var intro_block_array,intro_block_img_array=new Array,intro_block_img_obj=new Object,intro_shown=!1,selected_groupID=0,animating_groupID=0,grid_groups=new Object,total_groups=6,gray_scale_active=!1,grid_active=!1,plane_motion_on_locked_state=!1,section_video_called=!1,rebuild_grid_called=!1,set_grid_img_path,set_grid_bg_img,assets_preloader=html5Preloader(),assets_to_preload=new Array,hide_preloader_called=!1,current_section="site_loader",prev_section="",locked_section="",locked_prev_section="",os_type="unknown",os_label="unknown",site_w=0,site_h=0,x,i;$(document).ready(function(){var e=1;intro_block_array=$(".intro_block").toArray(),$(".intro_block").each(function(){$(this).data("width",String($(this).width())),$(this).data("height",String($(this).height())),$(this).data("xpos",String($(this).css("left"))),$(this).data("ypos",String($(this).css("top"))),$(this).data("id",e),e++}).click(function(e){grid_active&&selectGroupID($(this).data("groupID"))}),$("#section_video").bind("ended",function(){section_video_called?hideVideo():log("vid end")}),$("#site_footer_logo").click(function(e){onSiteLogoPress()}),$("img").on("dragstart",function(e){e.preventDefault()}),$(".pause_close_tab").hover(function(){TweenLite.to(this,.75,{css:{width:"115px",backgroundColor:"#FFFFFF"},ease:Strong.easeOut})},function(){TweenLite.to(this,.5,{css:{width:"28px",backgroundColor:"#1c1c1c"},ease:Expo.easeOut})}),$.get("./configuration/grid_thumnails.xml",function(e){}).done(function(e){x=e.getElementsByTagName("photo"),onInfoLoaded(),setSoundEffects()}),log("starting animation")}),$("#preloader_assets").ready(function(){var e=new Array("title_loader.gif","title_loader_bg.gif","entrance_title_logo.png"),o=0,i=function(){var t=new Image;t.onload=function(){++o,o<e.length?i():showMainPreloader()},t.src="http://wretchedbeauty.com.s3.amazonaws.com/configuration/preload_assets/"+e[o]};i()}),$(window).resize(function(){site_w=Number(window.innerWidth),site_h=Number(window.innerHeight),onGalleryResize()}),$("img").error(function(){$(this).css({visibility:"hidden"})});